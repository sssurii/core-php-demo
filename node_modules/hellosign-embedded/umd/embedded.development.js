(function webpackUniversalModuleDefinition(root, factory) {
	if(typeof exports === 'object' && typeof module === 'object')
		module.exports = factory();
	else if(typeof define === 'function' && define.amd)
		define([], factory);
	else if(typeof exports === 'object')
		exports["HelloSign"] = factory();
	else
		root["HelloSign"] = factory();
})(window, function() {
return /******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, {
/******/ 				configurable: false,
/******/ 				enumerable: true,
/******/ 				get: getter
/******/ 			});
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "./src/embedded.js");
/******/ })
/************************************************************************/
/******/ ({

/***/ "./package.json":
/*!**********************!*\
  !*** ./package.json ***!
  \**********************/
/*! exports provided: name, version, description, homepage, main, license, scripts, repository, author, devDependencies, files, default */
/***/ (function(module) {

module.exports = {"name":"hellosign-embedded","version":"1.5.2","description":"Embed HelloSign signature requests and templates from within your web application.","homepage":"https://github.com/HelloFax/hellosign-embedded","main":"index.js","license":"ISC","scripts":{"build":"webpack","demo":"npm run build && npm start --prefix=demo","prerelease":"node scripts/pre-release.js","setup":"npm install && npm run build && npm run setup --prefix=demo","test":"mocha test"},"repository":{"type":"git","url":"https://github.com/HelloFax/hellosign-embedded.git"},"author":{"name":"HelloSign","email":"api@hellosign.com","url":"https://hellosign.com"},"devDependencies":{"@babel/core":"^7.0.0-beta.42","@babel/plugin-proposal-object-rest-spread":"^7.0.0-beta.42","@babel/plugin-transform-object-assign":"^7.0.0-beta.42","@babel/preset-env":"^7.0.0-beta.42","babel-loader":"^8.0.0-beta.2","chai":"^4.1.2","jsdom":"^11.6.2","jsdom-global":"^3.0.2","mocha":"^5.0.4","webpack":"^4.2.0","webpack-cli":"^2.0.13"},"files":["umd","index.js"]};

/***/ }),

/***/ "./src/embedded.js":
/*!*************************!*\
  !*** ./src/embedded.js ***!
  \*************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";


function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

/**
 * HelloSign JS library for embeddables
 * Copyright (c) 2016 HelloSign
 *
 * XWM - Cross-window messaging inspired by Ben Alman's
 * jQuery postMessage plugin:
 * http://benalman.com/projects/jquery-postmessage-plugin/
 *
 *    Copyright (c) 2009 "Cowboy" Ben Alman
 *    Dual licensed under the MIT and GPL licenses.
 *    http://benalman.com/about/license/
 */
(function () {
  function getUrlVars() {
    var vars = {};
    var parts = window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi, function (m, key, value) {
      vars[key] = value;
    });
    return vars;
  } // Underscore.js debounce implementation.
  //
  // Returns a function, that, as long as it continues to be invoked, will not
  // be triggered. The function will be called after it stops being called for
  // N milliseconds. If `immediate` is passed, trigger the function on the
  // leading edge, instead of the trailing.


  function debounce(func, wait, immediate) {
    var timeout;
    return function () {
      var context = this,
          args = arguments;

      var later = function later() {
        timeout = null;
        if (!immediate) func.apply(context, args);
      };

      var callNow = immediate && !timeout;
      clearTimeout(timeout);
      timeout = setTimeout(later, wait);
      if (callNow) func.apply(context, args);
    };
  }

  var urlVars = getUrlVars();
  window.isDebugEnabled = urlVars.debug ? urlVars.debug === 'true' : false;
  var userAgent = navigator.userAgent.toLowerCase();
  var XWM = {
    cacheBust: 0,
    lastHash: 0,
    intervalId: 0,
    rmCallback: null,
    defaultDelay: 500,
    hasPostMessage: window['postMessage'] !== undefined,
    _serializeMessageValue: function _serializeMessageValue(value) {
      if (_typeof(value) === 'object') {
        value = JSON.stringify(value);
      }

      return encodeURIComponent(value);
    },
    send: function send(message, targetUrl, target) {
      l('XWM Send: Sending Message.');
      l('  targetUrl: ' + targetUrl);
      var self = XWM;

      if (!targetUrl) {
        return;
      } // Serialize the message into a string


      if (typeof message != 'string') {
        var parts = [];

        for (var k in message) {
          parts.push(k + '=' + this._serializeMessageValue(message[k]));
        }

        message = parts.join('&');
      }

      l('  message: ' + message);

      if (self.hasPostMessage) {
        // The browser supports window.postMessage, so call it with a targetOrigin
        // set appropriately, based on the targetUrl parameter.
        target = target || parent;
        target['postMessage'](message, targetUrl.replace(/([^:]+:\/\/[^\/]+).*/, '$1'));
      } else if (targetUrl) {
        // The browser does not support window.postMessage, so set the location
        // of the target to targetUrl#message. A bit ugly, but it works! A cache
        // bust parameter is added to ensure that repeat messages trigger the
        // callback.
        var t = new Date().getTime();
        var c = ++self.cacheBust;
        var targetFrame = document.getElementById(target); // target is the window id in this case
        // targetWindow.location = targetUrl.replace( /#.*$/, '' ) + '#' + t + c + '&' + message;

        if (targetFrame) {
          targetFrame.setAttribute('src', targetUrl.replace(/#.*$/, '') + '#' + t + c + '&' + message);
        } else {
          parent.location = targetUrl.replace(/#.*$/, '') + '#' + t + c + '&' + message;
        }
      }

      l('XWM Send: Message sent.');
    },
    receive: function receive(callback, sourceOrigin, delay) {
      if (typeof callback !== 'function') {
        error('callback must be a function');
      }

      if (typeof sourceOrigin !== 'string') {
        error('sourceOrigin must be a string');
      }

      l('XWM Receive: Initialize receiver.');
      l('  callback: ' + (callback.name ? callback.name : 'Anonymous function'));
      l('  sourceOrigin: ' + sourceOrigin);
      var self = XWM;

      if (self.hasPostMessage) {
        // Since the browser supports window.postMessage, the callback will be
        // bound to the actual event associated with window.postMessage.
        if (callback) {
          if (self.rmCallback) {
            // Unbind previous callback
            if (window['addEventListener']) {
              window['removeEventListener']('message', self.rmCallback, false);
            } else {
              //IE8 doesn't support removeEventListener
              window['detachEvent']('onmessage', self.rmCallback);
            }
          } // Bind the callback. A reference to the callback is stored for ease of unbinding


          self.rmCallback = function (evt) {
            // Ensure the event is originating from the source domain, accounting
            // for subdomains (evt.origin must end with a dot and the sourceOrigin string).
            if (evt.origin !== sourceOrigin) {
              var subdomainTest = new RegExp('[\/|\.]' + sourceOrigin + '$', 'i');

              if (!subdomainTest.test(evt.origin)) {
                return false;
              }
            }

            l('XWM Receive: Message received!');
            l('  data: ' + evt.data);
            l('  sourceOrigin: ' + sourceOrigin);
            callback(evt);
          };
        }

        if (window['addEventListener']) {
          window['addEventListener']('message', self.rmCallback, false);
        } else {
          //IE8 doesn't support addEventListener
          window['attachEvent']('onmessage', self.rmCallback);
        }
      } else {
        // Since the browser sucks, a polling loop will be started, and the
        // callback will be called whenever the location.hash changes.
        l('XWM Receive: Starting poll...');

        if (self.intervalId) {
          clearInterval(self.intervalId);
          self.intervalId = null;
        }

        if (typeof delay === 'undefined') {
          delay = self.defaultDelay;
        }

        if (callback) {
          delay = delay !== undefined ? delay : 200;
          self.intervalId = setInterval(function () {
            var hash = document.location.hash;
            var re = /^#?\d+&/;

            if (hash !== self.lastHash && re.test(hash)) {
              self.lastHash = hash;
              var data = hash.replace(re, '');
              l('XWM Receive: Message received!');
              l('  data: ' + data);
              l('  sourceOrigin: ' + sourceOrigin);
              callback({
                data: data
              });
            }
          }, delay);
        }
      }
    }
  };
  /**
   * Helper functions to manage the "viewport" meta tag.
   * This allows us to dynamically control the display
   * and placement of the iFrame in a mobile context.
   */

  var MetaTagHelper = {
    savedViewportContent: '',
    set: function set() {
      l('Optimizing viewport meta tag for mobile'); // Save off the current viewport meta tag content

      this.savedViewportContent = this._getElement().getAttribute('content'); // Add mobile-optimized settings

      var contentPairs = this._explodePairs(this.savedViewportContent);

      contentPairs['width'] = 'device-width';
      contentPairs['maximum-scale'] = '1.0';
      contentPairs['user-scalable'] = 'no';

      this._getElement().setAttribute('content', this._joinPairs(contentPairs));
    },
    restore: function restore() {
      l('Restoring viewport meta tag');

      this._getElement().setAttribute('content', this.savedViewportContent);
    },
    _getElement: function _getElement() {
      var el = document.querySelector('meta[name=viewport]');

      if (!el) {
        el = document.createElement('meta');
        el.setAttribute('name', 'viewport');
        el.setAttribute('content', 'initial-scale=1.0');
        document.head.appendChild(el);
      }

      return el;
    },
    _joinPairs: function _joinPairs(keyed) {
      var pairs = [];

      for (var key in keyed) {
        pairs.push(key + '=' + keyed[key]);
      }

      return pairs.join(', ');
    },
    _explodePairs: function _explodePairs(metaString) {
      var pairs = metaString.split(',');
      var obj = {};
      pairs.forEach(function (pair) {
        pair = pair.trim();
        var kv = pair.split('=');
        obj[kv[0]] = kv[1];
      });
      return obj;
    }
  };
  var HelloSign = {
    VERSION: __webpack_require__(/*! ../package.json */ "./package.json").version,
    DEFAULT_UX_VERSION: 1,
    IFRAME_WIDTH_RATIO: 0.8,
    DEFAULT_WIDTH: 900,
    DEFAULT_HEIGHT: 900,
    MIN_HEIGHT: 480,
    wrapper: null,
    iframe: null,
    overlay: null,
    cancelButton: null,
    clientId: null,
    isOldIE: /msie (8|7|6|5)/gi.test(userAgent),
    isFF: /firefox/gi.test(userAgent),
    isOpera: /opera/gi.test(userAgent),
    isMobile: /android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(userAgent),
    baseUrl: 'https://www.hellosign.com',
    cdnBaseUrl: 'https://s3.amazonaws.com/cdn.hellofax.com',
    XWM: XWM,
    CULTURES: {
      EN_US: 'en_US',
      FR_FR: 'fr_FR',
      DE_DE: 'de_DE',
      SV_SE: 'sv_SE',
      ZH_CN: 'zh_CN',
      DA_DK: 'da_DK',
      NL_NL: 'nl_NL',
      ES_ES: 'es_ES',
      ES_MX: 'es_MX',
      PT_BR: 'pt_BR',
      PL_PL: 'pl_PL',
      init: function init() {
        this.supportedCultures = [this.EN_US, this.FR_FR, this.DE_DE, this.SV_SE, this.ZH_CN, this.DA_DK, this.NL_NL, this.ES_ES, this.ES_MX, this.PT_BR, this.PL_PL];
        return this;
      }
    }.init(),
    isDebugEnabled: window.isDebugEnabled,
    // PUBLIC EVENTS
    // ---------------------------
    // - error                          An error occurred in the iFrame
    // - signature_request_signed       The signature request was signed
    // - signature_request_canceled     The user closed the iFrame before completing
    // THESE EVENT CODES ARE ACTUALLY USED IN TWO PLACES
    // IF YOU CHANGE THEM MAKE SURE TO CHANGE THE OTHERS
    // IN HFACTIONS.PHP TO STAY CONSISTENT.
    EVENT_SIGNED: 'signature_request_signed',
    EVENT_DECLINED: 'signature_request_declined',
    EVENT_CANCELED: 'signature_request_canceled',
    EVENT_REASSIGNED: 'signature_request_reassigned',
    EVENT_SENT: 'signature_request_sent',
    EVENT_TEMPLATE_CREATED: 'template_created',
    EVENT_ERROR: 'error',
    //  ----  PUBLIC METHODS  -----------------------------
    init: function init(appClientId) {
      this.clientId = appClientId;
    },
    open: function open(params) {
      var self = this; // PARAMETERS:
      // ----------------------
      // - url                      String. The url to open in the child frame
      // - redirectUrl              String. Where to go after the signature is completed
      // - allowCancel              Boolean. Whether a cancel button should be displayed (default = true)
      // - messageListener          Function. A listener for X-window messages coming from the child frame
      // - userCulture              HelloSign.CULTURE. One of the HelloSign.CULTURES.supportedCultures (default = HelloSign.CULTURES.EN_US)
      // - debug                    Boolean. When true, debugging statements will be written to the console (default = false)
      // - skipDomainVerification   Boolean. When true, domain verification step will be skipped if and only if the Signature Request was created with test_mode=1 (default = false)
      // - container                DOM element that will contain the iframe on the page (default = document.body)
      // - height                   Height of the iFrame (only applicable when a container is specified)
      // - hideHeader               Boolean. When true, the header will be hidden (default = false). This is only functional for customers with embedded branding enabled.
      // - uxVersion                Integer. The version of the embedded user experience to display to signers (1 = legacy, 2 = responsive). This option is only honored if your account has accessed the API prior to Nov 14, 2015.
      // - requester                String. The email of the person issuing a signature request. Required for allowing 'Me + Others' requests
      // - whiteLabelingOptions     Object. An associative array to be used to customize the app's signer page
      // - healthCheckTimeoutMs     Integer. The number of milliseconds to wait for a response from the iframe. If no response after that time the iframe will be closed. 15000 milliseconds is recommended.
      // - finalButtonText          String. The text to use for the final send/continue button if you'd like to override it's default text. May only be set to "Send" or "Continue".

      var redirectUrl = this.safeUrl(params['redirectUrl']);
      var messageListener = params['messageListener'];
      var frameUrl = this.safeUrl(params['url']);
      this.uxVersion = params['uxVersion'] || this.DEFAULT_UX_VERSION;
      this.isDefaultUX = this.uxVersion === this.DEFAULT_UX_VERSION;
      this.healthCheckTimeoutMs = params['healthCheckTimeoutMs'];

      if (this.uxVersion) {
        frameUrl += (frameUrl.indexOf('?') > 0 ? '&' : '?') + 'ux_version=' + this.uxVersion;
      }

      if (typeof params['debug'] !== 'undefined') {
        this.isDebugEnabled = params['debug'] === true || params['debug'] == 'true';
      }

      if (typeof params['skipDomainVerification'] !== 'undefined') {
        this.skipDomainVerification = params['skipDomainVerification'] === true || params['skipDomainVerification'] == 'true';
      }

      if (typeof params['hideHeader'] !== 'undefined') {
        this.hideHeader = params['hideHeader'] === true || params['hideHeader'] == 'true';
      }

      if (typeof params['finalButtonText'] !== 'undefined') {
        this.finalButtonText = params['finalButtonText'];
      }

      if (_typeof(params['whiteLabelingOptions']) === 'object') {
        this.whiteLabelingOptions = JSON.stringify(params['whiteLabelingOptions']);
        this.whiteLabelingOptions = this.whiteLabelingOptions.replace(/#/g, '');
      } else if (typeof params['whiteLabelingOptions'] !== 'undefined') {
        l("Invalid white labeling options supplied, option will be ignored: " + params['whiteLabelingOptions']);
      }

      this.isInPage = params['container'] !== undefined;
      this.container = params['container'] || document.body; // Validate parameters

      if (this.isInPage && params['height'] !== undefined && (isNaN(parseInt(params['height'], 10)) || params['height'] <= 0)) {
        throw new Error('Invalid iFrame height (' + params['height'] + ') it must be a valid positive number');
      }

      l('Opening HelloSign embedded iFrame with the following params:');
      l(params);

      if (!frameUrl) {
        throw new Error('No url specified');
      }

      var userCulture = typeof params['userCulture'] === 'undefined' ? this.CULTURES.EN_US : params['userCulture'];

      if (this.inArray(userCulture, this.CULTURES.supportedCultures) === -1) {
        throw new Error('Invalid userCulture specified: ' + userCulture);
      }

      frameUrl += frameUrl.indexOf('?') > 0 ? '&' : '?';

      if (redirectUrl) {
        frameUrl += 'redirect_url=' + encodeURIComponent(redirectUrl) + '&';
      }

      frameUrl += 'parent_url=' + encodeURIComponent(document.location.href.replace(/\?.*/, '')) + '&';
      frameUrl += this.skipDomainVerification === true ? 'skip_domain_verification=1&' : '';
      frameUrl += 'client_id=' + this.clientId + '&';
      frameUrl += typeof params['requester'] !== 'undefined' ? 'requester=' + encodeURIComponent(params['requester']) + '&' : '';
      frameUrl += 'user_culture=' + userCulture;

      if (this.isDebugEnabled) {
        frameUrl += '&debug=true';
      }

      if (this.hideHeader) {
        frameUrl += '&hideHeader=true';
      }

      if (this.whiteLabelingOptions) {
        frameUrl += '&white_labeling_options=' + encodeURI(this.whiteLabelingOptions);
      }

      if (this.finalButtonText) {
        frameUrl += '&final_button_text=' + this.finalButtonText;
      }

      frameUrl += '&js_version=' + this.VERSION;
      var origin = frameUrl.replace(/([^:]+:\/\/[^\/]+).*/, '$1');
      var windowDims = this.getWindowDimensions(params['height']);
      var styles = {
        'overlay': {
          'position': 'fixed',
          'top': '0px',
          'left': '0px',
          'bottom': '0px',
          'right': '0px',
          'z-index': 9997,
          'display': 'block',
          'background-color': '#222',
          'opacity': 0.4,
          '-khtml-opacity': 0.4,
          '-moz-opacity': 0.4,
          'filter': 'alpha(opacity=40)',
          '-ms-filter': 'progid:DXImageTransform.Microsoft.Alpha(Opacity=40)'
        },
        'wrapper': this.isInPage ? {} : {
          'position': 'absolute',
          'top': windowDims.top,
          'left': windowDims.left,
          'z-index': 9998
        },
        'iframe': this.isInPage ? {} : {
          'margin': '1px',
          'background-color': '#FFF',
          'z-index': 9998
        },
        'cancelButton': {
          'position': 'absolute',
          'top': '-13px',
          'right': '-13px',
          'width': '30px',
          'height': '30px',
          'background-image': 'url(' + this.cdnBaseUrl + '/css/fancybox/fancybox.png)',
          'background-position': '-40px 0px',
          'cursor': 'pointer',
          'z-index': 9999
        }
      };

      var resizeIFrame = function _resizeIFrame() {
        if (self.iframe) {
          var dims = {};

          if (self.isMobile) {
            dims = self.getMobileDimensions();
          } else {
            dims = self.getWindowDimensions();
          }

          self.wrapper.style['top'] = dims.top;
          self.wrapper.style['left'] = dims.left;
          self.wrapper.style['width'] = dims.widthString;
          self.iframe.style['height'] = dims.heightString;
          self.iframe.style['width'] = dims.widthString;
        }
      };

      if (this.uxVersion > 1) {
        if (this.isInPage) {
          // Adjust the iFrame style to fit the in-page container
          styles['wrapper']['width'] = '100%';
          styles['wrapper']['height'] = windowDims.heightString;
          styles['iframe']['width'] = '100%';
          styles['iframe']['height'] = windowDims.heightString;
          styles['iframe']['border'] = 'none';
          styles['iframe']['box-shadow'] = 'none';
          styles['cancelButton']['display'] = 'none'; // This is an iOS hack.  Apparently iOS ignores widths set
          // with a non-pixel value, which means iFrames get expanded
          // to the full width of their content.  Setting a pixel
          // value and then using `min-width` is the workaround for
          // this.
          // See:  http://stackoverflow.com/questions/23083462/how-to-get-an-iframe-to-be-responsive-in-ios-safari

          if (this.isMobile) {
            styles['iframe']['width'] = '1px';
            styles['iframe']['min-width'] = '100%';
          }
        } else if (this.isMobile) {
          var mobileDims = this.getMobileDimensions(); // Adjust the iFrame style to fit the whole screen

          styles['wrapper']['position'] = 'absolute';
          styles['wrapper']['top'] = '0';
          styles['wrapper']['left'] = '0';
          styles['wrapper']['width'] = mobileDims.widthString;
          styles['wrapper']['height'] = mobileDims.heightString;
          styles['iframe']['position'] = 'absolute';
          styles['iframe']['top'] = 0;
          styles['iframe']['left'] = 0;
          styles['iframe']['width'] = mobileDims.widthString;
          styles['iframe']['height'] = mobileDims.heightString;
          styles['iframe']['border'] = 'none';
          styles['iframe']['box-shadow'] = 'none';
          styles['cancelButton']['display'] = 'none';
        }
      } // Build overlay


      if (!this.isInPage) {
        if (!this.overlay) {
          this.overlay = document.createElement('div');
          this.overlay.setAttribute('id', 'hsEmbeddedOverlay');
          document.body.appendChild(this.overlay);
        }

        this.overlay.setAttribute('style', 'display: block;');
      } // Build the wrapper


      if (!this.wrapper) {
        this.wrapper = document.createElement('div');
        this.wrapper.setAttribute('id', 'hsEmbeddedWrapper'); // Hack.  We need this on mobile before we insert the DOM
        // element, otherwise the modal appears above the fold

        if (this.isMobile) {
          window.scrollTo(0, 0);
        }

        this.container.appendChild(this.wrapper);
      }

      if (!this.isInPage) {
        if (this.isMobile && this.isDefaultUX) {
          // If this is a mobile device, poll the window dimensions to see
          // if the zoom scale changes and resize the iFrame. This prevents
          // the user from zooming and getting into a state where they can't
          // submit the embedded request
          var zoomScale = document.body.clientWidth / window.innerWidth;

          var detectZoom = function _detectZoom() {
            var newZoomScale = document.body.clientWidth / window.innerWidth;

            if (zoomScale !== newZoomScale) {
              zoomScale = newZoomScale;
              resizeIFrame();
            }
          };

          window.onscroll = detectZoom;
        } else {
          // When the window is resized, also resize the iframe if necessary
          // NOTE: Only do this when the iFrame is displayed as a popup, it does not really make sense when it's in-page
          // Also used for new mobile ux
          window.onresize = resizeIFrame;
        }
      } // Build the iFrame


      if (!this.iframe) {
        this.iframe = document.createElement('iframe');
        this.iframe.setAttribute('id', 'hsEmbeddedFrame');
        this.wrapper.appendChild(this.iframe);
      }

      this.iframe.setAttribute('src', frameUrl);
      this.iframe.setAttribute('scrolling', 'no'); // This needs to stay as 'no' or else iPads, etc. get broken

      this.iframe.setAttribute('frameborder', '0');

      if (this.isDefaultUX) {
        this.iframe.setAttribute('width', this.DEFAULT_WIDTH);
      }

      this.iframe.setAttribute('height', windowDims.heightRaw); // TODO: Detecting 'embeddedSign' in the frameUrl is a hack. Clean
      // this up once the embedded close button has been implemented for
      // embedded requesting and templates.

      if (frameUrl.indexOf('embeddedSign') === -1 || params['uxVersion'] != null && params['uxVersion'] < 2) {
        if (!this.isInPage && (params['allowCancel'] === true || params['allowCancel'] === undefined) && !this.cancelButton) {
          this.cancelButton = document.createElement('a');
          this.cancelButton.setAttribute('id', 'hsEmbeddedCancel');
          this.cancelButton.setAttribute('href', 'javascript:;');

          this.cancelButton.onclick = function () {
            // Close iFrame
            HelloSign.close(); // Send 'cancel' message

            if (messageListener) {
              l('Reporting cancelation');
              messageListener({
                'event': HelloSign.EVENT_CANCELED
              });
            }
          };

          this.wrapper.appendChild(this.cancelButton);
        } else if (!params['allowCancel'] && this.cancelButton) {
          this.wrapper.removeChild(this.cancelButton);
        }
      } // Add inline styling


      for (var k in styles) {
        var el = this[k];

        if (el) {
          for (var i in styles[k]) {
            try {
              el.style[i] = styles[k][i];
            } catch (e) {
              // Ignore - exceptions get thrown when the given style is not supported
              l(e);
            }
          }
        }
      }

      if (this.cancelButton && (this.isFF || this.isOpera)) {
        // Firefox is weird with bg images
        var s = this.cancelButton.getAttribute('style');
        s += s ? '; ' : '';
        s += 'background-image: ' + styles.cancelButton['background-image'] + '; ';
        s += 'background-position: ' + styles.cancelButton['background-position'] + ';';
        this.cancelButton.setAttribute('style', s);
      }

      if (!this.isInPage && (!this.isMobile || this.isDefaultUX)) {
        // Run resizeIFrame to make sure it fits best from the beginning
        resizeIFrame();
      }

      if (this.isMobile && !this.isDefaultUX && window === window.top) {
        // Only set the meta tags for the top window
        MetaTagHelper.set();
      }

      if (this.isMobile && !this.isInPage) {
        this.fixIframe = debounce(function () {
          window.scrollTo(0, 0);
        }, 1000);
        this.fixIframe();
        window.addEventListener('scroll', this.fixIframe);
      } // Close the iframe if page fails to initialize within 15 seconds


      if (this.healthCheckTimeoutMs) {
        this._healthCheckTimeoutHandle = setTimeout(function () {
          var message = 'Signer page failed to initialize within ' + self.healthCheckTimeoutMs + ' milliseconds.';
          self.reportError(message, document.location.href);
          self.close();
        }, this.healthCheckTimeoutMs);
      } // Start listening for messages from the iFrame


      XWM.receive(function _parentWindowCallback(evt) {
        var source = evt.source || 'hsEmbeddedFrame';

        if (evt.data === 'initialize' && params['uxVersion'] > 1) {
          if (self.healthCheckTimeoutMs) clearTimeout(self._healthCheckTimeoutHandle); // remove container from payload to prevent circular reference error

          var payload = _extends({}, params);

          delete payload.container;
          XWM.send(JSON.stringify({
            type: 'embeddedConfig',
            payload: payload
          }), evt.origin, source);
        } else if (evt.data == 'close') {
          // Close iFrame
          HelloSign.close();

          if (messageListener && params['uxVersion'] > 1) {
            messageListener({
              'event': HelloSign.EVENT_CANCELED
            });
          }
        } else if (evt.data == 'decline') {
          // Close iFrame
          HelloSign.close();
          messageListener({
            'event': HelloSign.EVENT_DECLINED
          });
        } else if (evt.data == 'reassign') {
          messageListener({
            'event': HelloSign.EVENT_REASSIGNED
          });
        } else if (evt.data == 'user-done') {
          // Close iFrame
          HelloSign.close();
        } else if (typeof evt.data === 'string' && evt.data.indexOf('hello:') === 0) {
          // Hello message - Extract token and send it back
          var parts = evt.data.split(':');
          var token = parts[1];
          XWM.send('helloback:' + token, frameUrl, source);
        } else if (messageListener && evt.data && typeof evt.data === 'string') {
          // Forward to message callback
          var eventData = {};
          var p,
              pairs = evt.data.split('&'); // Recursive helper function to deserialize the event data.

          var deserializeEventData = function deserializeEventData(str) {
            var obj = str;

            try {
              // Safely parse the string
              obj = JSON.parse(str);

              if (_typeof(obj) === 'object') {
                for (var key in obj) {
                  obj[key] = parseJson(obj[key]);
                }
              }
            } catch (e) {
              /* ignore */
            }

            return obj;
          };

          for (var i = 0; i < pairs.length; i++) {
            p = pairs[i].split('=');

            if (p.length === 2) {
              eventData[p[0]] = deserializeEventData(decodeURIComponent(p[1]));
            }
          }

          messageListener(eventData);
        }
      }, origin);
    },
    close: function close() {
      // Reset viewport settings
      if (this.isMobile && !this.isDefaultUX && window === window.top) {
        MetaTagHelper.restore();
      }

      l('Closing HelloSign embedded iFrame'); // Close the child iframe from the parent window

      if (this.iframe) {
        var self = this;

        if (this.cancelButton) {
          this.wrapper.removeChild(this.cancelButton);
          this.cancelButton = null;
        }

        this._fadeOutIFrame();
      }

      if (this.isMobile) {
        window.removeEventListener('scroll', this.fixIframe);
      }
    },
    //  ----  PRIVATE METHODS  ----------------------------
    _fadeOutIFrame: function _fadeOutIFrame(currentOpacity) {
      var self = this;

      if (self.iframe) {
        if (!currentOpacity) {
          currentOpacity = 1.0;
        } else {
          currentOpacity -= 0.1;
        }

        self.iframe.style.opacity = currentOpacity;
        self.iframe.style.filter = 'alpha(opacity=' + parseInt(currentOpacity * 100, 10) + ')';

        if (currentOpacity <= 0.0) {
          self.iframe.style.opacity = 0;
          self.iframe.style.filter = 'alpha(opacity=0)';
          self.iframe.style.display = 'none';
          clearTimeout(animationTimer);

          if (self.overlay) {
            self.container.removeChild(self.overlay);
          }

          self.container.removeChild(self.wrapper);
          self.wrapper.removeChild(self.iframe);
          self.overlay = null;
          self.iframe = null;
          self.wrapper = null;
          return false;
        }

        var animationTimer = setTimeout(function (currentOpacity) {
          return function () {
            self._fadeOutIFrame(currentOpacity);
          };
        }(currentOpacity), 10);
      }
    },
    reportError: function reportError(errorMessage, parentUrl) {
      XWM.send({
        'event': HelloSign.EVENT_ERROR,
        'description': errorMessage
      }, parentUrl);
    },
    ensureParentDomain: function ensureParentDomain(domainName, parentUrl, token, skipDomainVerification, callback) {
      // domainName:  Domain to match against the parent window location
      // parentUrl:   Url of the parent window to check (provided to us but not reliable)
      // callback:    Method to call with the result, it should take only one boolean parameter.
      if (window.top == window) {
        // Not in an iFrame, no need to go further
        callback(true);
        return;
      }

      if (typeof token !== 'string') {
        error('Token not supplied by HelloSign. Please contact support.');
        return;
      }

      if (typeof callback !== 'function') {
        error('Callback not supplied by HelloSign. Please contact support.');
        return;
      }

      if (skipDomainVerification === true) {
        var warningMsg = 'Domain verification has been skipped. Before requesting approval for your app, please be sure to test domain verification by setting skipDomainVerification to false.';
        l(warningMsg);
        alert(warningMsg);
        callback(true);
      } else {
        // Starts waiting for the hello back message
        XWM.receive(function _ensureParentDomainCallback(evt) {
          if (evt.data.indexOf('helloback:') === 0) {
            var parts = evt.data.split(':');
            var valid = parts[1] == token;
            callback(valid);
          }
        }, domainName);
      } // Send hello message


      XWM.send('hello:' + token, parentUrl);
    },
    getWindowDimensions: function getWindowDimensions(customHeight) {
      var scrollX = getScrollX();
      var scrollY = getScrollY();
      var windowWidth, windowHeight;

      if (this.isOldIE) {
        windowWidth = document.body.clientWidth;
        windowHeight = document.body.clientHeight;
      } else {
        windowWidth = window.innerWidth;
        windowHeight = window.innerHeight;
      }

      var height = this.isInPage && customHeight ? customHeight : Math.max(this.MIN_HEIGHT, windowHeight - 60);
      var width = this.uxVersion > 1 ? Math.min(this.DEFAULT_WIDTH, windowWidth * this.IFRAME_WIDTH_RATIO) : this.DEFAULT_WIDTH;
      return {
        'widthString': width + 'px',
        'heightString': height + 'px',
        'heightRaw': height,
        'scrollX': scrollX,
        'scrollY': scrollY,
        'top': Math.max(0, scrollY + parseInt((windowHeight - height) / 2, 10)) + 'px',
        'left': Math.max(0, parseInt((windowWidth - this.DEFAULT_WIDTH) / 2, 10)) + 'px'
      };
    },
    getMobileDimensions: function getMobileDimensions() {
      var dims;
      var screenWidth = screen.width;
      var screenHeight = screen.height;
      var windowWidth = window.innerWidth;
      var windowHeight = window.innerHeight;
      var isPortrait = windowHeight > windowWidth;

      if (isPortrait) {
        dims = {
          'widthString': this.isDefaultUX ? '100vw' : screenWidth + 'px',
          'heightString': this.isDefaultUX ? '100vh' : '100%' // 100vh needed for old signer page, but cuts off some newer UX elements

        };
      } else {
        // Landscape
        dims = {
          'widthString': windowWidth + 'px',
          'heightString': this.isDefaultUX ? '100vh' : '100%'
        };
      } // Always fill screen on mobile


      dims.top = '0';
      dims.left = '0';
      return dims;
    },
    inArray: function inArray(v, array) {
      if (this.hasJQuery) {
        return $.inArray(v, array);
      } else if (array) {
        for (var i = 0; i < array.length; i++) {
          if (array[i] == v) {
            return i;
          }
        }
      }

      return -1;
    },
    safeUrl: function safeUrl(url) {
      if (url) {
        try {
          // Security: remove script tags from URLs before processing
          url = url.replace(/</g, "&lt;");
          url = url.replace(/>/g, "&gt;"); // HTML-Decode the given url if necessary, by rendering to the page

          var el = document.createElement('div');
          el.innerHTML = url;
          var decodedUrl = el.innerText; // Fall back to just replacing '&amp;' in case of failure

          if (!decodedUrl) {
            url = url.replace(/\&amp\;/g, '&');
          } else {
            url = decodedUrl;
          }
        } catch (e) {
          l('Could not decode url: ' + e);
        }
      }

      return url;
    }
  };
  /**
   * Wrapper that will ensure an error message is displayed, either in console.log
   * or as a browser alert.
   * @param message String error message
   */

  function error(message) {
    if (typeof message !== 'undefined') {
      if (window.console && console.log) {
        console.log(message);
      } else {
        alert(message);
      }
    }
  }
  /**
   * Custom wrapper that conditionally logs messages to console.log.
   * @param messageObj String or Object to log
   */


  function l(messageObj) {
    if (HelloSign.isDebugEnabled && typeof messageObj !== 'undefined' && window.console && console.log) {
      console.log(messageObj);
    }
  }
  /**
   *  Getter functions for determining scroll position that work on all
   *  browsers.
   */


  function getScrollX() {
    return _supportPageOffset() ? window.pageXOffset : _isCSS1Compat() ? document.documentElement.scrollLeft : document.body.scrollLeft;
  }

  function getScrollY() {
    return _supportPageOffset() ? window.pageYOffset : _isCSS1Compat() ? document.documentElement.scrollTop : document.body.scrollTop;
  }

  function _isCSS1Compat() {
    return (document.compatMode || '') === 'CSS1Compat';
  }

  function _supportPageOffset() {
    return window.pageXOffset !== undefined;
  } // Also add HelloSign as global variable for AMD implementations.
  // This will prevent older integrations from breaking.


  if (true) {
    window.HelloSign = HelloSign;
  } // Export the HS object


  module.exports = HelloSign;
})();

/***/ })

/******/ });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9IZWxsb1NpZ24vd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uIiwid2VicGFjazovL0hlbGxvU2lnbi93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9IZWxsb1NpZ24vLi9zcmMvZW1iZWRkZWQuanMiXSwibmFtZXMiOlsiZ2V0VXJsVmFycyIsInZhcnMiLCJwYXJ0cyIsIndpbmRvdyIsImxvY2F0aW9uIiwiaHJlZiIsInJlcGxhY2UiLCJtIiwia2V5IiwidmFsdWUiLCJkZWJvdW5jZSIsImZ1bmMiLCJ3YWl0IiwiaW1tZWRpYXRlIiwidGltZW91dCIsImNvbnRleHQiLCJhcmdzIiwiYXJndW1lbnRzIiwibGF0ZXIiLCJhcHBseSIsImNhbGxOb3ciLCJjbGVhclRpbWVvdXQiLCJzZXRUaW1lb3V0IiwidXJsVmFycyIsImlzRGVidWdFbmFibGVkIiwiZGVidWciLCJ1c2VyQWdlbnQiLCJuYXZpZ2F0b3IiLCJ0b0xvd2VyQ2FzZSIsIlhXTSIsImNhY2hlQnVzdCIsImxhc3RIYXNoIiwiaW50ZXJ2YWxJZCIsInJtQ2FsbGJhY2siLCJkZWZhdWx0RGVsYXkiLCJoYXNQb3N0TWVzc2FnZSIsInVuZGVmaW5lZCIsIl9zZXJpYWxpemVNZXNzYWdlVmFsdWUiLCJKU09OIiwic3RyaW5naWZ5IiwiZW5jb2RlVVJJQ29tcG9uZW50Iiwic2VuZCIsIm1lc3NhZ2UiLCJ0YXJnZXRVcmwiLCJ0YXJnZXQiLCJsIiwic2VsZiIsImsiLCJwdXNoIiwiam9pbiIsInBhcmVudCIsInQiLCJEYXRlIiwiZ2V0VGltZSIsImMiLCJ0YXJnZXRGcmFtZSIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJzZXRBdHRyaWJ1dGUiLCJyZWNlaXZlIiwiY2FsbGJhY2siLCJzb3VyY2VPcmlnaW4iLCJkZWxheSIsImVycm9yIiwibmFtZSIsImV2dCIsIm9yaWdpbiIsInN1YmRvbWFpblRlc3QiLCJSZWdFeHAiLCJ0ZXN0IiwiZGF0YSIsImNsZWFySW50ZXJ2YWwiLCJzZXRJbnRlcnZhbCIsImhhc2giLCJyZSIsIk1ldGFUYWdIZWxwZXIiLCJzYXZlZFZpZXdwb3J0Q29udGVudCIsInNldCIsIl9nZXRFbGVtZW50IiwiZ2V0QXR0cmlidXRlIiwiY29udGVudFBhaXJzIiwiX2V4cGxvZGVQYWlycyIsIl9qb2luUGFpcnMiLCJyZXN0b3JlIiwiZWwiLCJxdWVyeVNlbGVjdG9yIiwiY3JlYXRlRWxlbWVudCIsImhlYWQiLCJhcHBlbmRDaGlsZCIsImtleWVkIiwicGFpcnMiLCJtZXRhU3RyaW5nIiwic3BsaXQiLCJvYmoiLCJmb3JFYWNoIiwicGFpciIsInRyaW0iLCJrdiIsIkhlbGxvU2lnbiIsIlZFUlNJT04iLCJyZXF1aXJlIiwidmVyc2lvbiIsIkRFRkFVTFRfVVhfVkVSU0lPTiIsIklGUkFNRV9XSURUSF9SQVRJTyIsIkRFRkFVTFRfV0lEVEgiLCJERUZBVUxUX0hFSUdIVCIsIk1JTl9IRUlHSFQiLCJ3cmFwcGVyIiwiaWZyYW1lIiwib3ZlcmxheSIsImNhbmNlbEJ1dHRvbiIsImNsaWVudElkIiwiaXNPbGRJRSIsImlzRkYiLCJpc09wZXJhIiwiaXNNb2JpbGUiLCJiYXNlVXJsIiwiY2RuQmFzZVVybCIsIkNVTFRVUkVTIiwiRU5fVVMiLCJGUl9GUiIsIkRFX0RFIiwiU1ZfU0UiLCJaSF9DTiIsIkRBX0RLIiwiTkxfTkwiLCJFU19FUyIsIkVTX01YIiwiUFRfQlIiLCJQTF9QTCIsImluaXQiLCJzdXBwb3J0ZWRDdWx0dXJlcyIsIkVWRU5UX1NJR05FRCIsIkVWRU5UX0RFQ0xJTkVEIiwiRVZFTlRfQ0FOQ0VMRUQiLCJFVkVOVF9SRUFTU0lHTkVEIiwiRVZFTlRfU0VOVCIsIkVWRU5UX1RFTVBMQVRFX0NSRUFURUQiLCJFVkVOVF9FUlJPUiIsImFwcENsaWVudElkIiwib3BlbiIsInBhcmFtcyIsInJlZGlyZWN0VXJsIiwic2FmZVVybCIsIm1lc3NhZ2VMaXN0ZW5lciIsImZyYW1lVXJsIiwidXhWZXJzaW9uIiwiaXNEZWZhdWx0VVgiLCJoZWFsdGhDaGVja1RpbWVvdXRNcyIsImluZGV4T2YiLCJza2lwRG9tYWluVmVyaWZpY2F0aW9uIiwiaGlkZUhlYWRlciIsImZpbmFsQnV0dG9uVGV4dCIsIndoaXRlTGFiZWxpbmdPcHRpb25zIiwiaXNJblBhZ2UiLCJjb250YWluZXIiLCJib2R5IiwiaXNOYU4iLCJwYXJzZUludCIsIkVycm9yIiwidXNlckN1bHR1cmUiLCJpbkFycmF5IiwiZW5jb2RlVVJJIiwid2luZG93RGltcyIsImdldFdpbmRvd0RpbWVuc2lvbnMiLCJzdHlsZXMiLCJ0b3AiLCJsZWZ0IiwicmVzaXplSUZyYW1lIiwiX3Jlc2l6ZUlGcmFtZSIsImRpbXMiLCJnZXRNb2JpbGVEaW1lbnNpb25zIiwic3R5bGUiLCJ3aWR0aFN0cmluZyIsImhlaWdodFN0cmluZyIsIm1vYmlsZURpbXMiLCJzY3JvbGxUbyIsInpvb21TY2FsZSIsImNsaWVudFdpZHRoIiwiaW5uZXJXaWR0aCIsImRldGVjdFpvb20iLCJfZGV0ZWN0Wm9vbSIsIm5ld1pvb21TY2FsZSIsIm9uc2Nyb2xsIiwib25yZXNpemUiLCJoZWlnaHRSYXciLCJvbmNsaWNrIiwiY2xvc2UiLCJyZW1vdmVDaGlsZCIsImkiLCJlIiwicyIsImZpeElmcmFtZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJfaGVhbHRoQ2hlY2tUaW1lb3V0SGFuZGxlIiwicmVwb3J0RXJyb3IiLCJfcGFyZW50V2luZG93Q2FsbGJhY2siLCJzb3VyY2UiLCJwYXlsb2FkIiwidHlwZSIsInRva2VuIiwiZXZlbnREYXRhIiwicCIsImRlc2VyaWFsaXplRXZlbnREYXRhIiwic3RyIiwicGFyc2UiLCJwYXJzZUpzb24iLCJsZW5ndGgiLCJkZWNvZGVVUklDb21wb25lbnQiLCJfZmFkZU91dElGcmFtZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJjdXJyZW50T3BhY2l0eSIsIm9wYWNpdHkiLCJmaWx0ZXIiLCJkaXNwbGF5IiwiYW5pbWF0aW9uVGltZXIiLCJlcnJvck1lc3NhZ2UiLCJwYXJlbnRVcmwiLCJlbnN1cmVQYXJlbnREb21haW4iLCJkb21haW5OYW1lIiwid2FybmluZ01zZyIsImFsZXJ0IiwiX2Vuc3VyZVBhcmVudERvbWFpbkNhbGxiYWNrIiwidmFsaWQiLCJjdXN0b21IZWlnaHQiLCJzY3JvbGxYIiwiZ2V0U2Nyb2xsWCIsInNjcm9sbFkiLCJnZXRTY3JvbGxZIiwid2luZG93V2lkdGgiLCJ3aW5kb3dIZWlnaHQiLCJjbGllbnRIZWlnaHQiLCJpbm5lckhlaWdodCIsImhlaWdodCIsIk1hdGgiLCJtYXgiLCJ3aWR0aCIsIm1pbiIsInNjcmVlbldpZHRoIiwic2NyZWVuIiwic2NyZWVuSGVpZ2h0IiwiaXNQb3J0cmFpdCIsInYiLCJhcnJheSIsImhhc0pRdWVyeSIsIiQiLCJ1cmwiLCJpbm5lckhUTUwiLCJkZWNvZGVkVXJsIiwiaW5uZXJUZXh0IiwiY29uc29sZSIsImxvZyIsIm1lc3NhZ2VPYmoiLCJfc3VwcG9ydFBhZ2VPZmZzZXQiLCJwYWdlWE9mZnNldCIsIl9pc0NTUzFDb21wYXQiLCJkb2N1bWVudEVsZW1lbnQiLCJzY3JvbGxMZWZ0IiwicGFnZVlPZmZzZXQiLCJzY3JvbGxUb3AiLCJjb21wYXRNb2RlIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNELE87QUNWQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBSztBQUNMO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLHlEQUFpRCxjQUFjO0FBQy9EOztBQUVBO0FBQ0E7QUFDQTtBQUNBLG1DQUEyQiwwQkFBMEIsRUFBRTtBQUN2RCx5Q0FBaUMsZUFBZTtBQUNoRDtBQUNBO0FBQ0E7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LElBQVQsQ0FBY3VHLFNBQXhIO0FBQ0g7O0FBRUQsV0FBU0osYUFBVCxHQUF5QjtBQUNyQixXQUFRLENBQUN2TSxTQUFTNE0sVUFBVCxJQUF1QixFQUF4QixNQUFnQyxZQUF4QztBQUNIOztBQUVELFdBQVNQLGtCQUFULEdBQThCO0FBQzFCLFdBQU8xUCxPQUFPMlAsV0FBUCxLQUF1QjFOLFNBQTlCO0FBQ0gsR0F2OUJNLENBeTlCUDtBQUNBOzs7QUFDQSxNQUFJLElBQUosRUFBZ0Q7QUFDOUNqQyxXQUFPK0YsU0FBUCxHQUFtQkEsU0FBbkI7QUFDRCxHQTc5Qk0sQ0ErOUJQOzs7QUFDQW1LLFNBQU9DLE9BQVAsR0FBaUJwSyxTQUFqQjtBQUVILENBbCtCRCxJIiwiZmlsZSI6ImVtYmVkZGVkLmRldmVsb3BtZW50LmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIHdlYnBhY2tVbml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uKHJvb3QsIGZhY3RvcnkpIHtcblx0aWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnICYmIHR5cGVvZiBtb2R1bGUgPT09ICdvYmplY3QnKVxuXHRcdG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpO1xuXHRlbHNlIGlmKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZClcblx0XHRkZWZpbmUoW10sIGZhY3RvcnkpO1xuXHRlbHNlIGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0Jylcblx0XHRleHBvcnRzW1wiSGVsbG9TaWduXCJdID0gZmFjdG9yeSgpO1xuXHRlbHNlXG5cdFx0cm9vdFtcIkhlbGxvU2lnblwiXSA9IGZhY3RvcnkoKTtcbn0pKHdpbmRvdywgZnVuY3Rpb24oKSB7XG5yZXR1cm4gIiwiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7XG4gXHRcdFx0XHRjb25maWd1cmFibGU6IGZhbHNlLFxuIFx0XHRcdFx0ZW51bWVyYWJsZTogdHJ1ZSxcbiBcdFx0XHRcdGdldDogZ2V0dGVyXG4gXHRcdFx0fSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSBcIi4vc3JjL2VtYmVkZGVkLmpzXCIpO1xuIiwiLyoqXG4gKiBIZWxsb1NpZ24gSlMgbGlicmFyeSBmb3IgZW1iZWRkYWJsZXNcbiAqIENvcHlyaWdodCAoYykgMjAxNiBIZWxsb1NpZ25cbiAqXG4gKiBYV00gLSBDcm9zcy13aW5kb3cgbWVzc2FnaW5nIGluc3BpcmVkIGJ5IEJlbiBBbG1hbidzXG4gKiBqUXVlcnkgcG9zdE1lc3NhZ2UgcGx1Z2luOlxuICogaHR0cDovL2JlbmFsbWFuLmNvbS9wcm9qZWN0cy9qcXVlcnktcG9zdG1lc3NhZ2UtcGx1Z2luL1xuICpcbiAqICAgIENvcHlyaWdodCAoYykgMjAwOSBcIkNvd2JveVwiIEJlbiBBbG1hblxuICogICAgRHVhbCBsaWNlbnNlZCB1bmRlciB0aGUgTUlUIGFuZCBHUEwgbGljZW5zZXMuXG4gKiAgICBodHRwOi8vYmVuYWxtYW4uY29tL2Fib3V0L2xpY2Vuc2UvXG4gKi9cblxuKGZ1bmN0aW9uKCl7XG5cbiAgICBmdW5jdGlvbiBnZXRVcmxWYXJzKCkge1xuICAgICAgICB2YXIgdmFycyA9IHt9O1xuICAgICAgICB2YXIgcGFydHMgPSB3aW5kb3cubG9jYXRpb24uaHJlZi5yZXBsYWNlKC9bPyZdKyhbXj0mXSspPShbXiZdKikvZ2ksXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24obSwga2V5LCB2YWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICB2YXJzW2tleV0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHZhcnM7XG4gICAgfVxuXG4gICAgLy8gVW5kZXJzY29yZS5qcyBkZWJvdW5jZSBpbXBsZW1lbnRhdGlvbi5cbiAgICAvL1xuICAgIC8vIFJldHVybnMgYSBmdW5jdGlvbiwgdGhhdCwgYXMgbG9uZyBhcyBpdCBjb250aW51ZXMgdG8gYmUgaW52b2tlZCwgd2lsbCBub3RcbiAgICAvLyBiZSB0cmlnZ2VyZWQuIFRoZSBmdW5jdGlvbiB3aWxsIGJlIGNhbGxlZCBhZnRlciBpdCBzdG9wcyBiZWluZyBjYWxsZWQgZm9yXG4gICAgLy8gTiBtaWxsaXNlY29uZHMuIElmIGBpbW1lZGlhdGVgIGlzIHBhc3NlZCwgdHJpZ2dlciB0aGUgZnVuY3Rpb24gb24gdGhlXG4gICAgLy8gbGVhZGluZyBlZGdlLCBpbnN0ZWFkIG9mIHRoZSB0cmFpbGluZy5cbiAgICBmdW5jdGlvbiBkZWJvdW5jZShmdW5jLCB3YWl0LCBpbW1lZGlhdGUpIHtcbiAgICAgICAgdmFyIHRpbWVvdXQ7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHZhciBjb250ZXh0ID0gdGhpcywgYXJncyA9IGFyZ3VtZW50cztcbiAgICAgICAgICAgIHZhciBsYXRlciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHRpbWVvdXQgPSBudWxsO1xuICAgICAgICAgICAgICAgIGlmICghaW1tZWRpYXRlKSBmdW5jLmFwcGx5KGNvbnRleHQsIGFyZ3MpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHZhciBjYWxsTm93ID0gaW1tZWRpYXRlICYmICF0aW1lb3V0O1xuICAgICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVvdXQpO1xuICAgICAgICAgICAgdGltZW91dCA9IHNldFRpbWVvdXQobGF0ZXIsIHdhaXQpO1xuICAgICAgICAgICAgaWYgKGNhbGxOb3cpIGZ1bmMuYXBwbHkoY29udGV4dCwgYXJncyk7XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgdmFyIHVybFZhcnMgPSBnZXRVcmxWYXJzKCk7XG4gICAgd2luZG93LmlzRGVidWdFbmFibGVkID0gKHVybFZhcnMuZGVidWcgPyB1cmxWYXJzLmRlYnVnID09PSAndHJ1ZScgOiBmYWxzZSk7XG5cbiAgICB2YXIgdXNlckFnZW50ID0gbmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpO1xuXG4gICAgdmFyIFhXTSA9IHtcblxuICAgICAgICBjYWNoZUJ1c3Q6IDAsXG4gICAgICAgIGxhc3RIYXNoOiAwLFxuICAgICAgICBpbnRlcnZhbElkOiAwLFxuICAgICAgICBybUNhbGxiYWNrOiBudWxsLFxuICAgICAgICBkZWZhdWx0RGVsYXk6IDUwMCxcbiAgICAgICAgaGFzUG9zdE1lc3NhZ2U6ICh3aW5kb3dbJ3Bvc3RNZXNzYWdlJ10gIT09IHVuZGVmaW5lZCksXG5cbiAgICAgICAgX3NlcmlhbGl6ZU1lc3NhZ2VWYWx1ZTogZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICAgICAgdmFsdWUgPSBKU09OLnN0cmluZ2lmeSh2YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gZW5jb2RlVVJJQ29tcG9uZW50KHZhbHVlKTtcbiAgICAgICAgfSxcblxuICAgICAgICBzZW5kOiBmdW5jdGlvbihtZXNzYWdlLCB0YXJnZXRVcmwsIHRhcmdldCkge1xuXG4gICAgICAgICAgICBsKCdYV00gU2VuZDogU2VuZGluZyBNZXNzYWdlLicpO1xuICAgICAgICAgICAgbCgnICB0YXJnZXRVcmw6ICcgKyB0YXJnZXRVcmwpO1xuXG4gICAgICAgICAgICB2YXIgc2VsZiA9IFhXTTtcblxuICAgICAgICAgICAgaWYgKCF0YXJnZXRVcmwpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFNlcmlhbGl6ZSB0aGUgbWVzc2FnZSBpbnRvIGEgc3RyaW5nXG4gICAgICAgICAgICBpZiAodHlwZW9mIG1lc3NhZ2UgIT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICB2YXIgcGFydHMgPSBbXTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBrIGluIG1lc3NhZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgcGFydHMucHVzaChrICsgJz0nICsgdGhpcy5fc2VyaWFsaXplTWVzc2FnZVZhbHVlKG1lc3NhZ2Vba10pKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgbWVzc2FnZSA9IHBhcnRzLmpvaW4oJyYnKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgbCgnICBtZXNzYWdlOiAnICsgbWVzc2FnZSk7XG5cbiAgICAgICAgICAgIGlmIChzZWxmLmhhc1Bvc3RNZXNzYWdlKSB7XG4gICAgICAgICAgICAgICAgLy8gVGhlIGJyb3dzZXIgc3VwcG9ydHMgd2luZG93LnBvc3RNZXNzYWdlLCBzbyBjYWxsIGl0IHdpdGggYSB0YXJnZXRPcmlnaW5cbiAgICAgICAgICAgICAgICAvLyBzZXQgYXBwcm9wcmlhdGVseSwgYmFzZWQgb24gdGhlIHRhcmdldFVybCBwYXJhbWV0ZXIuXG4gICAgICAgICAgICAgICAgdGFyZ2V0ID0gdGFyZ2V0IHx8IHBhcmVudDtcbiAgICAgICAgICAgICAgICB0YXJnZXRbJ3Bvc3RNZXNzYWdlJ10obWVzc2FnZSwgdGFyZ2V0VXJsLnJlcGxhY2UoIC8oW146XSs6XFwvXFwvW15cXC9dKykuKi8sICckMScgKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmICh0YXJnZXRVcmwpIHtcbiAgICAgICAgICAgICAgICAvLyBUaGUgYnJvd3NlciBkb2VzIG5vdCBzdXBwb3J0IHdpbmRvdy5wb3N0TWVzc2FnZSwgc28gc2V0IHRoZSBsb2NhdGlvblxuICAgICAgICAgICAgICAgIC8vIG9mIHRoZSB0YXJnZXQgdG8gdGFyZ2V0VXJsI21lc3NhZ2UuIEEgYml0IHVnbHksIGJ1dCBpdCB3b3JrcyEgQSBjYWNoZVxuICAgICAgICAgICAgICAgIC8vIGJ1c3QgcGFyYW1ldGVyIGlzIGFkZGVkIHRvIGVuc3VyZSB0aGF0IHJlcGVhdCBtZXNzYWdlcyB0cmlnZ2VyIHRoZVxuICAgICAgICAgICAgICAgIC8vIGNhbGxiYWNrLlxuICAgICAgICAgICAgICAgIHZhciB0ID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7XG4gICAgICAgICAgICAgICAgdmFyIGMgPSArK3NlbGYuY2FjaGVCdXN0O1xuICAgICAgICAgICAgICAgIHZhciB0YXJnZXRGcmFtZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRhcmdldCk7IC8vIHRhcmdldCBpcyB0aGUgd2luZG93IGlkIGluIHRoaXMgY2FzZVxuICAgICAgICAgICAgICAgIC8vIHRhcmdldFdpbmRvdy5sb2NhdGlvbiA9IHRhcmdldFVybC5yZXBsYWNlKCAvIy4qJC8sICcnICkgKyAnIycgKyB0ICsgYyArICcmJyArIG1lc3NhZ2U7XG4gICAgICAgICAgICAgICAgaWYgKHRhcmdldEZyYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIHRhcmdldEZyYW1lLnNldEF0dHJpYnV0ZSgnc3JjJywgdGFyZ2V0VXJsLnJlcGxhY2UoIC8jLiokLywgJycgKSArICcjJyArIHQgKyBjICsgJyYnICsgbWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBwYXJlbnQubG9jYXRpb24gPSB0YXJnZXRVcmwucmVwbGFjZSggLyMuKiQvLCAnJyApICsgJyMnICsgdCArIGMgKyAnJicgKyBtZXNzYWdlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgbCgnWFdNIFNlbmQ6IE1lc3NhZ2Ugc2VudC4nKTtcbiAgICAgICAgfSxcblxuICAgICAgICByZWNlaXZlOiBmdW5jdGlvbihjYWxsYmFjaywgc291cmNlT3JpZ2luLCBkZWxheSkge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBjYWxsYmFjayAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgIGVycm9yKCdjYWxsYmFjayBtdXN0IGJlIGEgZnVuY3Rpb24nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0eXBlb2Ygc291cmNlT3JpZ2luICE9PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgIGVycm9yKCdzb3VyY2VPcmlnaW4gbXVzdCBiZSBhIHN0cmluZycpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBsKCdYV00gUmVjZWl2ZTogSW5pdGlhbGl6ZSByZWNlaXZlci4nKTtcbiAgICAgICAgICAgIGwoJyAgY2FsbGJhY2s6ICcgKyAoY2FsbGJhY2submFtZSA/IGNhbGxiYWNrLm5hbWUgOiAnQW5vbnltb3VzIGZ1bmN0aW9uJykpO1xuICAgICAgICAgICAgbCgnICBzb3VyY2VPcmlnaW46ICcgKyBzb3VyY2VPcmlnaW4pO1xuXG4gICAgICAgICAgICB2YXIgc2VsZiA9IFhXTTtcblxuICAgICAgICAgICAgaWYgKHNlbGYuaGFzUG9zdE1lc3NhZ2UpIHtcblxuICAgICAgICAgICAgICAgIC8vIFNpbmNlIHRoZSBicm93c2VyIHN1cHBvcnRzIHdpbmRvdy5wb3N0TWVzc2FnZSwgdGhlIGNhbGxiYWNrIHdpbGwgYmVcbiAgICAgICAgICAgICAgICAvLyBib3VuZCB0byB0aGUgYWN0dWFsIGV2ZW50IGFzc29jaWF0ZWQgd2l0aCB3aW5kb3cucG9zdE1lc3NhZ2UuXG5cbiAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2spIHtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZi5ybUNhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBVbmJpbmQgcHJldmlvdXMgY2FsbGJhY2tcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh3aW5kb3dbJ2FkZEV2ZW50TGlzdGVuZXInXSApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3dbJ3JlbW92ZUV2ZW50TGlzdGVuZXInXSgnbWVzc2FnZScsIHNlbGYucm1DYWxsYmFjaywgZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9JRTggZG9lc24ndCBzdXBwb3J0IHJlbW92ZUV2ZW50TGlzdGVuZXJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3dbJ2RldGFjaEV2ZW50J10oJ29ubWVzc2FnZScsIHNlbGYucm1DYWxsYmFjayk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAvLyBCaW5kIHRoZSBjYWxsYmFjay4gQSByZWZlcmVuY2UgdG8gdGhlIGNhbGxiYWNrIGlzIHN0b3JlZCBmb3IgZWFzZSBvZiB1bmJpbmRpbmdcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5ybUNhbGxiYWNrID0gZnVuY3Rpb24oZXZ0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBFbnN1cmUgdGhlIGV2ZW50IGlzIG9yaWdpbmF0aW5nIGZyb20gdGhlIHNvdXJjZSBkb21haW4sIGFjY291bnRpbmdcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGZvciBzdWJkb21haW5zIChldnQub3JpZ2luIG11c3QgZW5kIHdpdGggYSBkb3QgYW5kIHRoZSBzb3VyY2VPcmlnaW4gc3RyaW5nKS5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChldnQub3JpZ2luICE9PSBzb3VyY2VPcmlnaW4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc3ViZG9tYWluVGVzdCA9IG5ldyBSZWdFeHAoJ1tcXC98XFwuXScgKyBzb3VyY2VPcmlnaW4gKyAnJCcsICdpJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFzdWJkb21haW5UZXN0LnRlc3QoZXZ0Lm9yaWdpbikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgbCgnWFdNIFJlY2VpdmU6IE1lc3NhZ2UgcmVjZWl2ZWQhJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBsKCcgIGRhdGE6ICcgKyBldnQuZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBsKCcgIHNvdXJjZU9yaWdpbjogJyArIHNvdXJjZU9yaWdpbik7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayhldnQpO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmICh3aW5kb3dbJ2FkZEV2ZW50TGlzdGVuZXInXSkge1xuICAgICAgICAgICAgICAgICAgICB3aW5kb3dbJ2FkZEV2ZW50TGlzdGVuZXInXSgnbWVzc2FnZScsIHNlbGYucm1DYWxsYmFjaywgZmFsc2UpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy9JRTggZG9lc24ndCBzdXBwb3J0IGFkZEV2ZW50TGlzdGVuZXJcbiAgICAgICAgICAgICAgICAgICAgd2luZG93WydhdHRhY2hFdmVudCddKCdvbm1lc3NhZ2UnLCBzZWxmLnJtQ2FsbGJhY2spO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAvLyBTaW5jZSB0aGUgYnJvd3NlciBzdWNrcywgYSBwb2xsaW5nIGxvb3Agd2lsbCBiZSBzdGFydGVkLCBhbmQgdGhlXG4gICAgICAgICAgICAgICAgLy8gY2FsbGJhY2sgd2lsbCBiZSBjYWxsZWQgd2hlbmV2ZXIgdGhlIGxvY2F0aW9uLmhhc2ggY2hhbmdlcy5cbiAgICAgICAgICAgICAgICBsKCdYV00gUmVjZWl2ZTogU3RhcnRpbmcgcG9sbC4uLicpO1xuXG4gICAgICAgICAgICAgICAgaWYgKHNlbGYuaW50ZXJ2YWxJZCkge1xuICAgICAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKHNlbGYuaW50ZXJ2YWxJZCk7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuaW50ZXJ2YWxJZCA9IG51bGw7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBkZWxheSA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgZGVsYXkgPSBzZWxmLmRlZmF1bHREZWxheTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2spIHtcblxuICAgICAgICAgICAgICAgICAgICBkZWxheSA9IChkZWxheSAhPT0gdW5kZWZpbmVkID8gZGVsYXkgOiAyMDApO1xuXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuaW50ZXJ2YWxJZCA9IHNldEludGVydmFsKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaGFzaCA9IGRvY3VtZW50LmxvY2F0aW9uLmhhc2g7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmUgPSAvXiM/XFxkKyYvO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGhhc2ggIT09IHNlbGYubGFzdEhhc2ggJiYgcmUudGVzdChoYXNoKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYubGFzdEhhc2ggPSBoYXNoO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYXRhID0gaGFzaC5yZXBsYWNlKHJlLCAnJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbCgnWFdNIFJlY2VpdmU6IE1lc3NhZ2UgcmVjZWl2ZWQhJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbCgnICBkYXRhOiAnICsgZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbCgnICBzb3VyY2VPcmlnaW46ICcgKyBzb3VyY2VPcmlnaW4pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKHsgZGF0YTogZGF0YSB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSwgZGVsYXkpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICB9O1xuXG4gICAgLyoqXG4gICAgICogSGVscGVyIGZ1bmN0aW9ucyB0byBtYW5hZ2UgdGhlIFwidmlld3BvcnRcIiBtZXRhIHRhZy5cbiAgICAgKiBUaGlzIGFsbG93cyB1cyB0byBkeW5hbWljYWxseSBjb250cm9sIHRoZSBkaXNwbGF5XG4gICAgICogYW5kIHBsYWNlbWVudCBvZiB0aGUgaUZyYW1lIGluIGEgbW9iaWxlIGNvbnRleHQuXG4gICAgICovXG4gICAgdmFyIE1ldGFUYWdIZWxwZXIgPSB7XG5cbiAgICAgICAgc2F2ZWRWaWV3cG9ydENvbnRlbnQ6ICcnLFxuXG4gICAgICAgIHNldDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBsKCdPcHRpbWl6aW5nIHZpZXdwb3J0IG1ldGEgdGFnIGZvciBtb2JpbGUnKTtcblxuICAgICAgICAgICAgLy8gU2F2ZSBvZmYgdGhlIGN1cnJlbnQgdmlld3BvcnQgbWV0YSB0YWcgY29udGVudFxuICAgICAgICAgICAgdGhpcy5zYXZlZFZpZXdwb3J0Q29udGVudCA9IHRoaXMuX2dldEVsZW1lbnQoKS5nZXRBdHRyaWJ1dGUoJ2NvbnRlbnQnKTtcblxuICAgICAgICAgICAgLy8gQWRkIG1vYmlsZS1vcHRpbWl6ZWQgc2V0dGluZ3NcbiAgICAgICAgICAgIHZhciBjb250ZW50UGFpcnMgPSB0aGlzLl9leHBsb2RlUGFpcnModGhpcy5zYXZlZFZpZXdwb3J0Q29udGVudCk7XG4gICAgICAgICAgICBjb250ZW50UGFpcnNbJ3dpZHRoJ10gPSAnZGV2aWNlLXdpZHRoJztcbiAgICAgICAgICAgIGNvbnRlbnRQYWlyc1snbWF4aW11bS1zY2FsZSddID0gJzEuMCc7XG4gICAgICAgICAgICBjb250ZW50UGFpcnNbJ3VzZXItc2NhbGFibGUnXSA9ICdubyc7XG4gICAgICAgICAgICB0aGlzLl9nZXRFbGVtZW50KCkuc2V0QXR0cmlidXRlKCdjb250ZW50JywgdGhpcy5fam9pblBhaXJzKGNvbnRlbnRQYWlycykpO1xuICAgICAgICB9LFxuXG4gICAgICAgIHJlc3RvcmU6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgbCgnUmVzdG9yaW5nIHZpZXdwb3J0IG1ldGEgdGFnJyk7XG4gICAgICAgICAgICB0aGlzLl9nZXRFbGVtZW50KCkuc2V0QXR0cmlidXRlKCdjb250ZW50JywgdGhpcy5zYXZlZFZpZXdwb3J0Q29udGVudCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgX2dldEVsZW1lbnQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIGVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignbWV0YVtuYW1lPXZpZXdwb3J0XScpO1xuICAgICAgICAgICAgaWYgKCFlbCkge1xuICAgICAgICAgICAgICAgIGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbWV0YScpO1xuICAgICAgICAgICAgICAgIGVsLnNldEF0dHJpYnV0ZSgnbmFtZScsICd2aWV3cG9ydCcpO1xuICAgICAgICAgICAgICAgIGVsLnNldEF0dHJpYnV0ZSgnY29udGVudCcsICdpbml0aWFsLXNjYWxlPTEuMCcpO1xuICAgICAgICAgICAgICAgIGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQoZWwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGVsO1xuICAgICAgICB9LFxuXG4gICAgICAgIF9qb2luUGFpcnM6IGZ1bmN0aW9uKGtleWVkKXtcbiAgICAgICAgICAgIHZhciBwYWlycyA9IFtdO1xuICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIGtleWVkKSB7XG4gICAgICAgICAgICAgICAgcGFpcnMucHVzaChrZXkgKyAnPScgKyBrZXllZFtrZXldKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBwYWlycy5qb2luKCcsICcpO1xuICAgICAgICB9LFxuXG4gICAgICAgIF9leHBsb2RlUGFpcnM6IGZ1bmN0aW9uKG1ldGFTdHJpbmcpe1xuICAgICAgICAgICAgdmFyIHBhaXJzID0gbWV0YVN0cmluZy5zcGxpdCgnLCcpO1xuICAgICAgICAgICAgdmFyIG9iaiA9IHt9O1xuICAgICAgICAgICAgcGFpcnMuZm9yRWFjaChmdW5jdGlvbihwYWlyKSB7XG4gICAgICAgICAgICAgICAgcGFpciA9IHBhaXIudHJpbSgpO1xuICAgICAgICAgICAgICAgIHZhciBrdiA9IHBhaXIuc3BsaXQoJz0nKTtcbiAgICAgICAgICAgICAgICBvYmpba3ZbMF1dID0ga3ZbMV07XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgcmV0dXJuIG9iajtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICB2YXIgSGVsbG9TaWduID0ge1xuXG4gICAgICAgIFZFUlNJT046IHJlcXVpcmUoJy4uL3BhY2thZ2UuanNvbicpLnZlcnNpb24sXG4gICAgICAgIERFRkFVTFRfVVhfVkVSU0lPTjogMSxcbiAgICAgICAgSUZSQU1FX1dJRFRIX1JBVElPOiAwLjgsXG4gICAgICAgIERFRkFVTFRfV0lEVEg6IDkwMCxcbiAgICAgICAgREVGQVVMVF9IRUlHSFQ6IDkwMCxcbiAgICAgICAgTUlOX0hFSUdIVDogNDgwLFxuICAgICAgICB3cmFwcGVyOiBudWxsLFxuICAgICAgICBpZnJhbWU6IG51bGwsXG4gICAgICAgIG92ZXJsYXk6IG51bGwsXG4gICAgICAgIGNhbmNlbEJ1dHRvbjogbnVsbCxcbiAgICAgICAgY2xpZW50SWQ6IG51bGwsXG4gICAgICAgIGlzT2xkSUU6ICgvbXNpZSAoOHw3fDZ8NSkvZ2kudGVzdCh1c2VyQWdlbnQpKSxcbiAgICAgICAgaXNGRjogKC9maXJlZm94L2dpLnRlc3QodXNlckFnZW50KSksXG4gICAgICAgIGlzT3BlcmE6ICgvb3BlcmEvZ2kudGVzdCh1c2VyQWdlbnQpKSxcbiAgICAgICAgaXNNb2JpbGU6ICgvYW5kcm9pZHx3ZWJvc3xpcGhvbmV8aXBhZHxpcG9kfGJsYWNrYmVycnl8aWVtb2JpbGV8b3BlcmEgbWluaS9pLnRlc3QodXNlckFnZW50KSksXG4gICAgICAgIGJhc2VVcmw6ICdodHRwczovL3d3dy5oZWxsb3NpZ24uY29tJyxcbiAgICAgICAgY2RuQmFzZVVybDogJ2h0dHBzOi8vczMuYW1hem9uYXdzLmNvbS9jZG4uaGVsbG9mYXguY29tJyxcbiAgICAgICAgWFdNOiBYV00sXG5cbiAgICAgICAgQ1VMVFVSRVM6IHtcbiAgICAgICAgICAgIEVOX1VTOiAnZW5fVVMnLFxuICAgICAgICAgICAgRlJfRlI6ICdmcl9GUicsXG4gICAgICAgICAgICBERV9ERTogJ2RlX0RFJyxcbiAgICAgICAgICAgIFNWX1NFOiAnc3ZfU0UnLFxuICAgICAgICAgICAgWkhfQ046ICd6aF9DTicsXG4gICAgICAgICAgICBEQV9ESzogJ2RhX0RLJyxcbiAgICAgICAgICAgIE5MX05MOiAnbmxfTkwnLFxuICAgICAgICAgICAgRVNfRVM6ICdlc19FUycsXG4gICAgICAgICAgICBFU19NWDogJ2VzX01YJyxcbiAgICAgICAgICAgIFBUX0JSOiAncHRfQlInLFxuICAgICAgICAgICAgUExfUEw6ICdwbF9QTCcsXG4gICAgICAgICAgICBpbml0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnN1cHBvcnRlZEN1bHR1cmVzID0gW3RoaXMuRU5fVVMsIHRoaXMuRlJfRlIsIHRoaXMuREVfREUsIHRoaXMuU1ZfU0UsIHRoaXMuWkhfQ04sIHRoaXMuREFfREssIHRoaXMuTkxfTkwsIHRoaXMuRVNfRVMsIHRoaXMuRVNfTVgsIHRoaXMuUFRfQlIsIHRoaXMuUExfUExdO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LmluaXQoKSxcblxuICAgICAgICBpc0RlYnVnRW5hYmxlZDogd2luZG93LmlzRGVidWdFbmFibGVkLFxuXG4gICAgICAgIC8vIFBVQkxJQyBFVkVOVFNcbiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgIC8vIC0gZXJyb3IgICAgICAgICAgICAgICAgICAgICAgICAgIEFuIGVycm9yIG9jY3VycmVkIGluIHRoZSBpRnJhbWVcbiAgICAgICAgLy8gLSBzaWduYXR1cmVfcmVxdWVzdF9zaWduZWQgICAgICAgVGhlIHNpZ25hdHVyZSByZXF1ZXN0IHdhcyBzaWduZWRcbiAgICAgICAgLy8gLSBzaWduYXR1cmVfcmVxdWVzdF9jYW5jZWxlZCAgICAgVGhlIHVzZXIgY2xvc2VkIHRoZSBpRnJhbWUgYmVmb3JlIGNvbXBsZXRpbmdcblxuXG4gICAgICAgIC8vIFRIRVNFIEVWRU5UIENPREVTIEFSRSBBQ1RVQUxMWSBVU0VEIElOIFRXTyBQTEFDRVNcbiAgICAgICAgLy8gSUYgWU9VIENIQU5HRSBUSEVNIE1BS0UgU1VSRSBUTyBDSEFOR0UgVEhFIE9USEVSU1xuICAgICAgICAvLyBJTiBIRkFDVElPTlMuUEhQIFRPIFNUQVkgQ09OU0lTVEVOVC5cbiAgICAgICAgRVZFTlRfU0lHTkVEOiAnc2lnbmF0dXJlX3JlcXVlc3Rfc2lnbmVkJyxcbiAgICAgICAgRVZFTlRfREVDTElORUQ6ICdzaWduYXR1cmVfcmVxdWVzdF9kZWNsaW5lZCcsXG4gICAgICAgIEVWRU5UX0NBTkNFTEVEOiAnc2lnbmF0dXJlX3JlcXVlc3RfY2FuY2VsZWQnLFxuICAgICAgICBFVkVOVF9SRUFTU0lHTkVEOiAnc2lnbmF0dXJlX3JlcXVlc3RfcmVhc3NpZ25lZCcsXG4gICAgICAgIEVWRU5UX1NFTlQ6ICdzaWduYXR1cmVfcmVxdWVzdF9zZW50JyxcbiAgICAgICAgRVZFTlRfVEVNUExBVEVfQ1JFQVRFRDogJ3RlbXBsYXRlX2NyZWF0ZWQnLFxuICAgICAgICBFVkVOVF9FUlJPUjogJ2Vycm9yJyxcblxuXG4gICAgICAgIC8vICAtLS0tICBQVUJMSUMgTUVUSE9EUyAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgICAgICBpbml0OiBmdW5jdGlvbihhcHBDbGllbnRJZCkge1xuICAgICAgICAgICAgdGhpcy5jbGllbnRJZCA9IGFwcENsaWVudElkO1xuICAgICAgICB9LFxuXG4gICAgICAgIG9wZW46IGZ1bmN0aW9uKHBhcmFtcykge1xuXG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgICAgIC8vIFBBUkFNRVRFUlM6XG4gICAgICAgICAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgICAgICAvLyAtIHVybCAgICAgICAgICAgICAgICAgICAgICBTdHJpbmcuIFRoZSB1cmwgdG8gb3BlbiBpbiB0aGUgY2hpbGQgZnJhbWVcbiAgICAgICAgICAgIC8vIC0gcmVkaXJlY3RVcmwgICAgICAgICAgICAgIFN0cmluZy4gV2hlcmUgdG8gZ28gYWZ0ZXIgdGhlIHNpZ25hdHVyZSBpcyBjb21wbGV0ZWRcbiAgICAgICAgICAgIC8vIC0gYWxsb3dDYW5jZWwgICAgICAgICAgICAgIEJvb2xlYW4uIFdoZXRoZXIgYSBjYW5jZWwgYnV0dG9uIHNob3VsZCBiZSBkaXNwbGF5ZWQgKGRlZmF1bHQgPSB0cnVlKVxuICAgICAgICAgICAgLy8gLSBtZXNzYWdlTGlzdGVuZXIgICAgICAgICAgRnVuY3Rpb24uIEEgbGlzdGVuZXIgZm9yIFgtd2luZG93IG1lc3NhZ2VzIGNvbWluZyBmcm9tIHRoZSBjaGlsZCBmcmFtZVxuICAgICAgICAgICAgLy8gLSB1c2VyQ3VsdHVyZSAgICAgICAgICAgICAgSGVsbG9TaWduLkNVTFRVUkUuIE9uZSBvZiB0aGUgSGVsbG9TaWduLkNVTFRVUkVTLnN1cHBvcnRlZEN1bHR1cmVzIChkZWZhdWx0ID0gSGVsbG9TaWduLkNVTFRVUkVTLkVOX1VTKVxuICAgICAgICAgICAgLy8gLSBkZWJ1ZyAgICAgICAgICAgICAgICAgICAgQm9vbGVhbi4gV2hlbiB0cnVlLCBkZWJ1Z2dpbmcgc3RhdGVtZW50cyB3aWxsIGJlIHdyaXR0ZW4gdG8gdGhlIGNvbnNvbGUgKGRlZmF1bHQgPSBmYWxzZSlcbiAgICAgICAgICAgIC8vIC0gc2tpcERvbWFpblZlcmlmaWNhdGlvbiAgIEJvb2xlYW4uIFdoZW4gdHJ1ZSwgZG9tYWluIHZlcmlmaWNhdGlvbiBzdGVwIHdpbGwgYmUgc2tpcHBlZCBpZiBhbmQgb25seSBpZiB0aGUgU2lnbmF0dXJlIFJlcXVlc3Qgd2FzIGNyZWF0ZWQgd2l0aCB0ZXN0X21vZGU9MSAoZGVmYXVsdCA9IGZhbHNlKVxuICAgICAgICAgICAgLy8gLSBjb250YWluZXIgICAgICAgICAgICAgICAgRE9NIGVsZW1lbnQgdGhhdCB3aWxsIGNvbnRhaW4gdGhlIGlmcmFtZSBvbiB0aGUgcGFnZSAoZGVmYXVsdCA9IGRvY3VtZW50LmJvZHkpXG4gICAgICAgICAgICAvLyAtIGhlaWdodCAgICAgICAgICAgICAgICAgICBIZWlnaHQgb2YgdGhlIGlGcmFtZSAob25seSBhcHBsaWNhYmxlIHdoZW4gYSBjb250YWluZXIgaXMgc3BlY2lmaWVkKVxuICAgICAgICAgICAgLy8gLSBoaWRlSGVhZGVyICAgICAgICAgICAgICAgQm9vbGVhbi4gV2hlbiB0cnVlLCB0aGUgaGVhZGVyIHdpbGwgYmUgaGlkZGVuIChkZWZhdWx0ID0gZmFsc2UpLiBUaGlzIGlzIG9ubHkgZnVuY3Rpb25hbCBmb3IgY3VzdG9tZXJzIHdpdGggZW1iZWRkZWQgYnJhbmRpbmcgZW5hYmxlZC5cbiAgICAgICAgICAgIC8vIC0gdXhWZXJzaW9uICAgICAgICAgICAgICAgIEludGVnZXIuIFRoZSB2ZXJzaW9uIG9mIHRoZSBlbWJlZGRlZCB1c2VyIGV4cGVyaWVuY2UgdG8gZGlzcGxheSB0byBzaWduZXJzICgxID0gbGVnYWN5LCAyID0gcmVzcG9uc2l2ZSkuIFRoaXMgb3B0aW9uIGlzIG9ubHkgaG9ub3JlZCBpZiB5b3VyIGFjY291bnQgaGFzIGFjY2Vzc2VkIHRoZSBBUEkgcHJpb3IgdG8gTm92IDE0LCAyMDE1LlxuICAgICAgICAgICAgLy8gLSByZXF1ZXN0ZXIgICAgICAgICAgICAgICAgU3RyaW5nLiBUaGUgZW1haWwgb2YgdGhlIHBlcnNvbiBpc3N1aW5nIGEgc2lnbmF0dXJlIHJlcXVlc3QuIFJlcXVpcmVkIGZvciBhbGxvd2luZyAnTWUgKyBPdGhlcnMnIHJlcXVlc3RzXG4gICAgICAgICAgICAvLyAtIHdoaXRlTGFiZWxpbmdPcHRpb25zICAgICBPYmplY3QuIEFuIGFzc29jaWF0aXZlIGFycmF5IHRvIGJlIHVzZWQgdG8gY3VzdG9taXplIHRoZSBhcHAncyBzaWduZXIgcGFnZVxuICAgICAgICAgICAgLy8gLSBoZWFsdGhDaGVja1RpbWVvdXRNcyAgICAgSW50ZWdlci4gVGhlIG51bWJlciBvZiBtaWxsaXNlY29uZHMgdG8gd2FpdCBmb3IgYSByZXNwb25zZSBmcm9tIHRoZSBpZnJhbWUuIElmIG5vIHJlc3BvbnNlIGFmdGVyIHRoYXQgdGltZSB0aGUgaWZyYW1lIHdpbGwgYmUgY2xvc2VkLiAxNTAwMCBtaWxsaXNlY29uZHMgaXMgcmVjb21tZW5kZWQuXG4gICAgICAgICAgICAvLyAtIGZpbmFsQnV0dG9uVGV4dCAgICAgICAgICBTdHJpbmcuIFRoZSB0ZXh0IHRvIHVzZSBmb3IgdGhlIGZpbmFsIHNlbmQvY29udGludWUgYnV0dG9uIGlmIHlvdSdkIGxpa2UgdG8gb3ZlcnJpZGUgaXQncyBkZWZhdWx0IHRleHQuIE1heSBvbmx5IGJlIHNldCB0byBcIlNlbmRcIiBvciBcIkNvbnRpbnVlXCIuXG5cbiAgICAgICAgICAgIHZhciByZWRpcmVjdFVybCA9IHRoaXMuc2FmZVVybChwYXJhbXNbJ3JlZGlyZWN0VXJsJ10pO1xuICAgICAgICAgICAgdmFyIG1lc3NhZ2VMaXN0ZW5lciA9IHBhcmFtc1snbWVzc2FnZUxpc3RlbmVyJ107XG4gICAgICAgICAgICB2YXIgZnJhbWVVcmwgPSB0aGlzLnNhZmVVcmwocGFyYW1zWyd1cmwnXSk7XG4gICAgICAgICAgICB0aGlzLnV4VmVyc2lvbiA9IHBhcmFtc1sndXhWZXJzaW9uJ10gfHwgdGhpcy5ERUZBVUxUX1VYX1ZFUlNJT047XG4gICAgICAgICAgICB0aGlzLmlzRGVmYXVsdFVYID0gKHRoaXMudXhWZXJzaW9uID09PSB0aGlzLkRFRkFVTFRfVVhfVkVSU0lPTik7XG4gICAgICAgICAgICB0aGlzLmhlYWx0aENoZWNrVGltZW91dE1zID0gcGFyYW1zWydoZWFsdGhDaGVja1RpbWVvdXRNcyddO1xuXG4gICAgICAgICAgICBpZiAodGhpcy51eFZlcnNpb24pIHtcbiAgICAgICAgICAgICAgICBmcmFtZVVybCArPSAoZnJhbWVVcmwuaW5kZXhPZignPycpID4gMCA/ICcmJyA6ICc/JykgKyAndXhfdmVyc2lvbj0nICsgdGhpcy51eFZlcnNpb247XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodHlwZW9mIHBhcmFtc1snZGVidWcnXSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmlzRGVidWdFbmFibGVkID0gKHBhcmFtc1snZGVidWcnXSA9PT0gdHJ1ZSB8fCBwYXJhbXNbJ2RlYnVnJ10gPT0gJ3RydWUnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0eXBlb2YgcGFyYW1zWydza2lwRG9tYWluVmVyaWZpY2F0aW9uJ10gIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5za2lwRG9tYWluVmVyaWZpY2F0aW9uID0gKHBhcmFtc1snc2tpcERvbWFpblZlcmlmaWNhdGlvbiddID09PSB0cnVlIHx8IHBhcmFtc1snc2tpcERvbWFpblZlcmlmaWNhdGlvbiddID09ICd0cnVlJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodHlwZW9mIHBhcmFtc1snaGlkZUhlYWRlciddICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgIHRoaXMuaGlkZUhlYWRlciA9IChwYXJhbXNbJ2hpZGVIZWFkZXInXSA9PT0gdHJ1ZSB8fCBwYXJhbXNbJ2hpZGVIZWFkZXInXSA9PSAndHJ1ZScpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHR5cGVvZiBwYXJhbXNbJ2ZpbmFsQnV0dG9uVGV4dCddICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgIHRoaXMuZmluYWxCdXR0b25UZXh0ID0gcGFyYW1zWydmaW5hbEJ1dHRvblRleHQnXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0eXBlb2YgcGFyYW1zWyd3aGl0ZUxhYmVsaW5nT3B0aW9ucyddID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgICAgIHRoaXMud2hpdGVMYWJlbGluZ09wdGlvbnMgPSBKU09OLnN0cmluZ2lmeShwYXJhbXNbJ3doaXRlTGFiZWxpbmdPcHRpb25zJ10pO1xuICAgICAgICAgICAgICAgIHRoaXMud2hpdGVMYWJlbGluZ09wdGlvbnMgPSB0aGlzLndoaXRlTGFiZWxpbmdPcHRpb25zLnJlcGxhY2UoLyMvZywgJycpO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgcGFyYW1zWyd3aGl0ZUxhYmVsaW5nT3B0aW9ucyddICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICAgICAgICAgIGwoXCJJbnZhbGlkIHdoaXRlIGxhYmVsaW5nIG9wdGlvbnMgc3VwcGxpZWQsIG9wdGlvbiB3aWxsIGJlIGlnbm9yZWQ6IFwiICsgcGFyYW1zWyd3aGl0ZUxhYmVsaW5nT3B0aW9ucyddKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuaXNJblBhZ2UgPSAocGFyYW1zWydjb250YWluZXInXSAhPT0gdW5kZWZpbmVkKTtcbiAgICAgICAgICAgIHRoaXMuY29udGFpbmVyID0gcGFyYW1zWydjb250YWluZXInXSB8fCBkb2N1bWVudC5ib2R5O1xuXG4gICAgICAgICAgICAvLyBWYWxpZGF0ZSBwYXJhbWV0ZXJzXG4gICAgICAgICAgICBpZiAodGhpcy5pc0luUGFnZSAmJiBwYXJhbXNbJ2hlaWdodCddICE9PSB1bmRlZmluZWQgJiYgKGlzTmFOKHBhcnNlSW50KHBhcmFtc1snaGVpZ2h0J10sIDEwKSkgfHwgcGFyYW1zWydoZWlnaHQnXSA8PSAwKSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignSW52YWxpZCBpRnJhbWUgaGVpZ2h0ICgnICsgcGFyYW1zWydoZWlnaHQnXSArICcpIGl0IG11c3QgYmUgYSB2YWxpZCBwb3NpdGl2ZSBudW1iZXInKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgbCgnT3BlbmluZyBIZWxsb1NpZ24gZW1iZWRkZWQgaUZyYW1lIHdpdGggdGhlIGZvbGxvd2luZyBwYXJhbXM6Jyk7XG4gICAgICAgICAgICBsKHBhcmFtcyk7XG5cbiAgICAgICAgICAgIGlmICghZnJhbWVVcmwpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIHVybCBzcGVjaWZpZWQnKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdmFyIHVzZXJDdWx0dXJlID0gdHlwZW9mIHBhcmFtc1sndXNlckN1bHR1cmUnXSA9PT0gJ3VuZGVmaW5lZCcgPyB0aGlzLkNVTFRVUkVTLkVOX1VTIDogcGFyYW1zWyd1c2VyQ3VsdHVyZSddO1xuICAgICAgICAgICAgaWYgKHRoaXMuaW5BcnJheSh1c2VyQ3VsdHVyZSwgdGhpcy5DVUxUVVJFUy5zdXBwb3J0ZWRDdWx0dXJlcykgPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIHVzZXJDdWx0dXJlIHNwZWNpZmllZDogJyArIHVzZXJDdWx0dXJlKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnJhbWVVcmwgKz0gKGZyYW1lVXJsLmluZGV4T2YoJz8nKSA+IDAgPyAnJicgOiAnPycpO1xuICAgICAgICAgICAgaWYgKHJlZGlyZWN0VXJsKSB7XG4gICAgICAgICAgICAgICAgZnJhbWVVcmwgKz0gJ3JlZGlyZWN0X3VybD0nICsgZW5jb2RlVVJJQ29tcG9uZW50KHJlZGlyZWN0VXJsKSArICcmJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZyYW1lVXJsICs9ICdwYXJlbnRfdXJsPScgKyBlbmNvZGVVUklDb21wb25lbnQoZG9jdW1lbnQubG9jYXRpb24uaHJlZi5yZXBsYWNlKC9cXD8uKi8sICcnKSkgKyAnJic7XG4gICAgICAgICAgICBmcmFtZVVybCArPSAodGhpcy5za2lwRG9tYWluVmVyaWZpY2F0aW9uID09PSB0cnVlID8gJ3NraXBfZG9tYWluX3ZlcmlmaWNhdGlvbj0xJicgOiAnJyk7XG4gICAgICAgICAgICBmcmFtZVVybCArPSAnY2xpZW50X2lkPScgKyB0aGlzLmNsaWVudElkICsgJyYnO1xuICAgICAgICAgICAgZnJhbWVVcmwgKz0gKHR5cGVvZiBwYXJhbXNbJ3JlcXVlc3RlciddICE9PSAndW5kZWZpbmVkJyA/ICdyZXF1ZXN0ZXI9JyArIGVuY29kZVVSSUNvbXBvbmVudChwYXJhbXNbJ3JlcXVlc3RlciddKSArICcmJyA6ICcnKTtcbiAgICAgICAgICAgIGZyYW1lVXJsICs9ICd1c2VyX2N1bHR1cmU9JyArIHVzZXJDdWx0dXJlO1xuICAgICAgICAgICAgaWYgKHRoaXMuaXNEZWJ1Z0VuYWJsZWQpIHtcbiAgICAgICAgICAgICAgICBmcmFtZVVybCArPSAnJmRlYnVnPXRydWUnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMuaGlkZUhlYWRlcikge1xuICAgICAgICAgICAgICAgIGZyYW1lVXJsICs9ICcmaGlkZUhlYWRlcj10cnVlJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLndoaXRlTGFiZWxpbmdPcHRpb25zKSB7XG4gICAgICAgICAgICAgICAgZnJhbWVVcmwgKz0gJyZ3aGl0ZV9sYWJlbGluZ19vcHRpb25zPScgKyBlbmNvZGVVUkkodGhpcy53aGl0ZUxhYmVsaW5nT3B0aW9ucyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAodGhpcy5maW5hbEJ1dHRvblRleHQpIHtcbiAgICAgICAgICAgICAgICBmcmFtZVVybCArPSAnJmZpbmFsX2J1dHRvbl90ZXh0PScgKyB0aGlzLmZpbmFsQnV0dG9uVGV4dDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnJhbWVVcmwgKz0gJyZqc192ZXJzaW9uPScgKyB0aGlzLlZFUlNJT047XG5cbiAgICAgICAgICAgIHZhciBvcmlnaW4gPSBmcmFtZVVybC5yZXBsYWNlKC8oW146XSs6XFwvXFwvW15cXC9dKykuKi8sICckMScpO1xuICAgICAgICAgICAgdmFyIHdpbmRvd0RpbXMgPSB0aGlzLmdldFdpbmRvd0RpbWVuc2lvbnMocGFyYW1zWydoZWlnaHQnXSk7XG4gICAgICAgICAgICB2YXIgc3R5bGVzID0ge1xuICAgICAgICAgICAgICAgICdvdmVybGF5Jzoge1xuICAgICAgICAgICAgICAgICAgICAncG9zaXRpb24nOiAnZml4ZWQnLFxuICAgICAgICAgICAgICAgICAgICAndG9wJzogJzBweCcsXG4gICAgICAgICAgICAgICAgICAgICdsZWZ0JzogJzBweCcsXG4gICAgICAgICAgICAgICAgICAgICdib3R0b20nOiAnMHB4JyxcbiAgICAgICAgICAgICAgICAgICAgJ3JpZ2h0JzogJzBweCcsXG4gICAgICAgICAgICAgICAgICAgICd6LWluZGV4JzogOTk5NyxcbiAgICAgICAgICAgICAgICAgICAgJ2Rpc3BsYXknOiAnYmxvY2snLFxuICAgICAgICAgICAgICAgICAgICAnYmFja2dyb3VuZC1jb2xvcic6ICcjMjIyJyxcbiAgICAgICAgICAgICAgICAgICAgJ29wYWNpdHknOiAwLjQsXG4gICAgICAgICAgICAgICAgICAgICcta2h0bWwtb3BhY2l0eSc6IDAuNCxcbiAgICAgICAgICAgICAgICAgICAgJy1tb3otb3BhY2l0eSc6IDAuNCxcbiAgICAgICAgICAgICAgICAgICAgJ2ZpbHRlcic6ICdhbHBoYShvcGFjaXR5PTQwKScsXG4gICAgICAgICAgICAgICAgICAgICctbXMtZmlsdGVyJzogJ3Byb2dpZDpEWEltYWdlVHJhbnNmb3JtLk1pY3Jvc29mdC5BbHBoYShPcGFjaXR5PTQwKSdcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICd3cmFwcGVyJzogdGhpcy5pc0luUGFnZSA/IHt9IDoge1xuICAgICAgICAgICAgICAgICAgICAncG9zaXRpb24nOiAnYWJzb2x1dGUnLFxuICAgICAgICAgICAgICAgICAgICAndG9wJzogd2luZG93RGltcy50b3AsXG4gICAgICAgICAgICAgICAgICAgICdsZWZ0Jzogd2luZG93RGltcy5sZWZ0LFxuICAgICAgICAgICAgICAgICAgICAnei1pbmRleCc6IDk5OThcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICdpZnJhbWUnOiB0aGlzLmlzSW5QYWdlID8ge30gOiB7XG4gICAgICAgICAgICAgICAgICAgICdtYXJnaW4nOiAnMXB4JyxcbiAgICAgICAgICAgICAgICAgICAgJ2JhY2tncm91bmQtY29sb3InOiAnI0ZGRicsXG4gICAgICAgICAgICAgICAgICAgICd6LWluZGV4JzogOTk5OFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgJ2NhbmNlbEJ1dHRvbic6IHtcbiAgICAgICAgICAgICAgICAgICAgJ3Bvc2l0aW9uJzogJ2Fic29sdXRlJyxcbiAgICAgICAgICAgICAgICAgICAgJ3RvcCc6ICctMTNweCcsXG4gICAgICAgICAgICAgICAgICAgICdyaWdodCc6ICctMTNweCcsXG4gICAgICAgICAgICAgICAgICAgICd3aWR0aCc6ICczMHB4JyxcbiAgICAgICAgICAgICAgICAgICAgJ2hlaWdodCc6ICczMHB4JyxcbiAgICAgICAgICAgICAgICAgICAgJ2JhY2tncm91bmQtaW1hZ2UnOiAndXJsKCcgKyB0aGlzLmNkbkJhc2VVcmwgKyAnL2Nzcy9mYW5jeWJveC9mYW5jeWJveC5wbmcpJyxcbiAgICAgICAgICAgICAgICAgICAgJ2JhY2tncm91bmQtcG9zaXRpb24nOiAnLTQwcHggMHB4JyxcbiAgICAgICAgICAgICAgICAgICAgJ2N1cnNvcic6ICdwb2ludGVyJyxcbiAgICAgICAgICAgICAgICAgICAgJ3otaW5kZXgnOiA5OTk5XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdmFyIHJlc2l6ZUlGcmFtZSA9IGZ1bmN0aW9uIF9yZXNpemVJRnJhbWUoKSB7XG4gICAgICAgICAgICAgICAgaWYgKHNlbGYuaWZyYW1lKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGRpbXMgPSB7fTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZi5pc01vYmlsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGltcyA9IHNlbGYuZ2V0TW9iaWxlRGltZW5zaW9ucygpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGltcyA9IHNlbGYuZ2V0V2luZG93RGltZW5zaW9ucygpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgc2VsZi53cmFwcGVyLnN0eWxlWyd0b3AnXSA9IGRpbXMudG9wO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLndyYXBwZXIuc3R5bGVbJ2xlZnQnXSA9IGRpbXMubGVmdDtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi53cmFwcGVyLnN0eWxlWyd3aWR0aCddID0gZGltcy53aWR0aFN0cmluZztcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5pZnJhbWUuc3R5bGVbJ2hlaWdodCddID0gZGltcy5oZWlnaHRTdHJpbmc7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuaWZyYW1lLnN0eWxlWyd3aWR0aCddID0gZGltcy53aWR0aFN0cmluZztcblxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGlmICh0aGlzLnV4VmVyc2lvbiA+IDEpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5pc0luUGFnZSkge1xuICAgICAgICAgICAgICAgICAgICAvLyBBZGp1c3QgdGhlIGlGcmFtZSBzdHlsZSB0byBmaXQgdGhlIGluLXBhZ2UgY29udGFpbmVyXG4gICAgICAgICAgICAgICAgICAgIHN0eWxlc1snd3JhcHBlciddWyd3aWR0aCddID0gJzEwMCUnO1xuICAgICAgICAgICAgICAgICAgICBzdHlsZXNbJ3dyYXBwZXInXVsnaGVpZ2h0J10gPSB3aW5kb3dEaW1zLmhlaWdodFN0cmluZztcbiAgICAgICAgICAgICAgICAgICAgc3R5bGVzWydpZnJhbWUnXVsnd2lkdGgnXSA9ICcxMDAlJztcbiAgICAgICAgICAgICAgICAgICAgc3R5bGVzWydpZnJhbWUnXVsnaGVpZ2h0J10gPSB3aW5kb3dEaW1zLmhlaWdodFN0cmluZztcbiAgICAgICAgICAgICAgICAgICAgc3R5bGVzWydpZnJhbWUnXVsnYm9yZGVyJ10gPSAnbm9uZSc7XG4gICAgICAgICAgICAgICAgICAgIHN0eWxlc1snaWZyYW1lJ11bJ2JveC1zaGFkb3cnXSA9ICdub25lJztcbiAgICAgICAgICAgICAgICAgICAgc3R5bGVzWydjYW5jZWxCdXR0b24nXVsnZGlzcGxheSddID0gJ25vbmUnO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIFRoaXMgaXMgYW4gaU9TIGhhY2suICBBcHBhcmVudGx5IGlPUyBpZ25vcmVzIHdpZHRocyBzZXRcbiAgICAgICAgICAgICAgICAgICAgLy8gd2l0aCBhIG5vbi1waXhlbCB2YWx1ZSwgd2hpY2ggbWVhbnMgaUZyYW1lcyBnZXQgZXhwYW5kZWRcbiAgICAgICAgICAgICAgICAgICAgLy8gdG8gdGhlIGZ1bGwgd2lkdGggb2YgdGhlaXIgY29udGVudC4gIFNldHRpbmcgYSBwaXhlbFxuICAgICAgICAgICAgICAgICAgICAvLyB2YWx1ZSBhbmQgdGhlbiB1c2luZyBgbWluLXdpZHRoYCBpcyB0aGUgd29ya2Fyb3VuZCBmb3JcbiAgICAgICAgICAgICAgICAgICAgLy8gdGhpcy5cbiAgICAgICAgICAgICAgICAgICAgLy8gU2VlOiAgaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy8yMzA4MzQ2Mi9ob3ctdG8tZ2V0LWFuLWlmcmFtZS10by1iZS1yZXNwb25zaXZlLWluLWlvcy1zYWZhcmlcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNNb2JpbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlc1snaWZyYW1lJ11bJ3dpZHRoJ10gPSAnMXB4JztcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlc1snaWZyYW1lJ11bJ21pbi13aWR0aCddID0gJzEwMCUnO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMuaXNNb2JpbGUpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG1vYmlsZURpbXMgPSB0aGlzLmdldE1vYmlsZURpbWVuc2lvbnMoKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gQWRqdXN0IHRoZSBpRnJhbWUgc3R5bGUgdG8gZml0IHRoZSB3aG9sZSBzY3JlZW5cbiAgICAgICAgICAgICAgICAgICAgc3R5bGVzWyd3cmFwcGVyJ11bJ3Bvc2l0aW9uJ10gPSAnYWJzb2x1dGUnO1xuICAgICAgICAgICAgICAgICAgICBzdHlsZXNbJ3dyYXBwZXInXVsndG9wJ10gPSAnMCc7XG4gICAgICAgICAgICAgICAgICAgIHN0eWxlc1snd3JhcHBlciddWydsZWZ0J10gPSAnMCc7XG4gICAgICAgICAgICAgICAgICAgIHN0eWxlc1snd3JhcHBlciddWyd3aWR0aCddID0gbW9iaWxlRGltcy53aWR0aFN0cmluZztcbiAgICAgICAgICAgICAgICAgICAgc3R5bGVzWyd3cmFwcGVyJ11bJ2hlaWdodCddID0gbW9iaWxlRGltcy5oZWlnaHRTdHJpbmc7XG4gICAgICAgICAgICAgICAgICAgIHN0eWxlc1snaWZyYW1lJ11bJ3Bvc2l0aW9uJ10gPSAnYWJzb2x1dGUnO1xuICAgICAgICAgICAgICAgICAgICBzdHlsZXNbJ2lmcmFtZSddWyd0b3AnXSA9IDA7XG4gICAgICAgICAgICAgICAgICAgIHN0eWxlc1snaWZyYW1lJ11bJ2xlZnQnXSA9IDA7XG4gICAgICAgICAgICAgICAgICAgIHN0eWxlc1snaWZyYW1lJ11bJ3dpZHRoJ10gPSBtb2JpbGVEaW1zLndpZHRoU3RyaW5nO1xuICAgICAgICAgICAgICAgICAgICBzdHlsZXNbJ2lmcmFtZSddWydoZWlnaHQnXSA9IG1vYmlsZURpbXMuaGVpZ2h0U3RyaW5nO1xuICAgICAgICAgICAgICAgICAgICBzdHlsZXNbJ2lmcmFtZSddWydib3JkZXInXSA9ICdub25lJztcbiAgICAgICAgICAgICAgICAgICAgc3R5bGVzWydpZnJhbWUnXVsnYm94LXNoYWRvdyddID0gJ25vbmUnO1xuICAgICAgICAgICAgICAgICAgICBzdHlsZXNbJ2NhbmNlbEJ1dHRvbiddWydkaXNwbGF5J10gPSAnbm9uZSc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBCdWlsZCBvdmVybGF5XG4gICAgICAgICAgICBpZiAoIXRoaXMuaXNJblBhZ2UpIHtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMub3ZlcmxheSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm92ZXJsYXkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vdmVybGF5LnNldEF0dHJpYnV0ZSgnaWQnLCAnaHNFbWJlZGRlZE92ZXJsYXknKTtcbiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCh0aGlzLm92ZXJsYXkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLm92ZXJsYXkuc2V0QXR0cmlidXRlKCdzdHlsZScsICdkaXNwbGF5OiBibG9jazsnKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gQnVpbGQgdGhlIHdyYXBwZXJcbiAgICAgICAgICAgIGlmICghdGhpcy53cmFwcGVyKSB7XG4gICAgICAgICAgICAgICAgdGhpcy53cmFwcGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgICAgICAgICAgdGhpcy53cmFwcGVyLnNldEF0dHJpYnV0ZSgnaWQnLCAnaHNFbWJlZGRlZFdyYXBwZXInKTtcblxuICAgICAgICAgICAgICAgIC8vIEhhY2suICBXZSBuZWVkIHRoaXMgb24gbW9iaWxlIGJlZm9yZSB3ZSBpbnNlcnQgdGhlIERPTVxuICAgICAgICAgICAgICAgIC8vIGVsZW1lbnQsIG90aGVyd2lzZSB0aGUgbW9kYWwgYXBwZWFycyBhYm92ZSB0aGUgZm9sZFxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzTW9iaWxlKSB7XG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5zY3JvbGxUbygwLCAwKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0aGlzLmNvbnRhaW5lci5hcHBlbmRDaGlsZCh0aGlzLndyYXBwZXIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoIXRoaXMuaXNJblBhZ2UpIHtcblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzTW9iaWxlICYmIHRoaXMuaXNEZWZhdWx0VVgpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gSWYgdGhpcyBpcyBhIG1vYmlsZSBkZXZpY2UsIHBvbGwgdGhlIHdpbmRvdyBkaW1lbnNpb25zIHRvIHNlZVxuICAgICAgICAgICAgICAgICAgICAvLyBpZiB0aGUgem9vbSBzY2FsZSBjaGFuZ2VzIGFuZCByZXNpemUgdGhlIGlGcmFtZS4gVGhpcyBwcmV2ZW50c1xuICAgICAgICAgICAgICAgICAgICAvLyB0aGUgdXNlciBmcm9tIHpvb21pbmcgYW5kIGdldHRpbmcgaW50byBhIHN0YXRlIHdoZXJlIHRoZXkgY2FuJ3RcbiAgICAgICAgICAgICAgICAgICAgLy8gc3VibWl0IHRoZSBlbWJlZGRlZCByZXF1ZXN0XG4gICAgICAgICAgICAgICAgICAgIHZhciB6b29tU2NhbGUgPSBkb2N1bWVudC5ib2R5LmNsaWVudFdpZHRoIC8gd2luZG93LmlubmVyV2lkdGg7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkZXRlY3Rab29tID0gZnVuY3Rpb24gX2RldGVjdFpvb20oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbmV3Wm9vbVNjYWxlID0gZG9jdW1lbnQuYm9keS5jbGllbnRXaWR0aCAvIHdpbmRvdy5pbm5lcldpZHRoO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHpvb21TY2FsZSAhPT0gbmV3Wm9vbVNjYWxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgem9vbVNjYWxlID0gbmV3Wm9vbVNjYWxlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc2l6ZUlGcmFtZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB3aW5kb3cub25zY3JvbGwgPSBkZXRlY3Rab29tO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gV2hlbiB0aGUgd2luZG93IGlzIHJlc2l6ZWQsIGFsc28gcmVzaXplIHRoZSBpZnJhbWUgaWYgbmVjZXNzYXJ5XG4gICAgICAgICAgICAgICAgICAgIC8vIE5PVEU6IE9ubHkgZG8gdGhpcyB3aGVuIHRoZSBpRnJhbWUgaXMgZGlzcGxheWVkIGFzIGEgcG9wdXAsIGl0IGRvZXMgbm90IHJlYWxseSBtYWtlIHNlbnNlIHdoZW4gaXQncyBpbi1wYWdlXG4gICAgICAgICAgICAgICAgICAgIC8vIEFsc28gdXNlZCBmb3IgbmV3IG1vYmlsZSB1eFxuICAgICAgICAgICAgICAgICAgICB3aW5kb3cub25yZXNpemUgPSByZXNpemVJRnJhbWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBCdWlsZCB0aGUgaUZyYW1lXG4gICAgICAgICAgICBpZiAoIXRoaXMuaWZyYW1lKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5pZnJhbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpZnJhbWUnKTtcbiAgICAgICAgICAgICAgICB0aGlzLmlmcmFtZS5zZXRBdHRyaWJ1dGUoJ2lkJywgJ2hzRW1iZWRkZWRGcmFtZScpO1xuICAgICAgICAgICAgICAgIHRoaXMud3JhcHBlci5hcHBlbmRDaGlsZCh0aGlzLmlmcmFtZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmlmcmFtZS5zZXRBdHRyaWJ1dGUoJ3NyYycsIGZyYW1lVXJsKTtcbiAgICAgICAgICAgIHRoaXMuaWZyYW1lLnNldEF0dHJpYnV0ZSgnc2Nyb2xsaW5nJywgJ25vJyk7IC8vIFRoaXMgbmVlZHMgdG8gc3RheSBhcyAnbm8nIG9yIGVsc2UgaVBhZHMsIGV0Yy4gZ2V0IGJyb2tlblxuICAgICAgICAgICAgdGhpcy5pZnJhbWUuc2V0QXR0cmlidXRlKCdmcmFtZWJvcmRlcicsICcwJyk7XG4gICAgICAgICAgICBpZiAodGhpcy5pc0RlZmF1bHRVWCkge1xuICAgICAgICAgICAgICAgIHRoaXMuaWZyYW1lLnNldEF0dHJpYnV0ZSgnd2lkdGgnLCB0aGlzLkRFRkFVTFRfV0lEVEgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLmlmcmFtZS5zZXRBdHRyaWJ1dGUoJ2hlaWdodCcsIHdpbmRvd0RpbXMuaGVpZ2h0UmF3KTtcblxuICAgICAgICAgICAgLy8gVE9ETzogRGV0ZWN0aW5nICdlbWJlZGRlZFNpZ24nIGluIHRoZSBmcmFtZVVybCBpcyBhIGhhY2suIENsZWFuXG4gICAgICAgICAgICAvLyB0aGlzIHVwIG9uY2UgdGhlIGVtYmVkZGVkIGNsb3NlIGJ1dHRvbiBoYXMgYmVlbiBpbXBsZW1lbnRlZCBmb3JcbiAgICAgICAgICAgIC8vIGVtYmVkZGVkIHJlcXVlc3RpbmcgYW5kIHRlbXBsYXRlcy5cbiAgICAgICAgICAgIGlmIChmcmFtZVVybC5pbmRleE9mKCdlbWJlZGRlZFNpZ24nKSA9PT0gLTEgfHwgcGFyYW1zWyd1eFZlcnNpb24nXSAhPSBudWxsICYmIHBhcmFtc1sndXhWZXJzaW9uJ10gPCAyKSB7XG4gICAgICAgICAgICAgIGlmICghdGhpcy5pc0luUGFnZSAmJiAocGFyYW1zWydhbGxvd0NhbmNlbCddID09PSB0cnVlIHx8IHBhcmFtc1snYWxsb3dDYW5jZWwnXSA9PT0gdW5kZWZpbmVkKSAmJiAhdGhpcy5jYW5jZWxCdXR0b24pIHtcbiAgICAgICAgICAgICAgICAgIHRoaXMuY2FuY2VsQnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xuICAgICAgICAgICAgICAgICAgdGhpcy5jYW5jZWxCdXR0b24uc2V0QXR0cmlidXRlKCdpZCcsICdoc0VtYmVkZGVkQ2FuY2VsJyk7XG4gICAgICAgICAgICAgICAgICB0aGlzLmNhbmNlbEJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2hyZWYnLCAnamF2YXNjcmlwdDo7Jyk7XG4gICAgICAgICAgICAgICAgICB0aGlzLmNhbmNlbEJ1dHRvbi5vbmNsaWNrID0gZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgICAvLyBDbG9zZSBpRnJhbWVcbiAgICAgICAgICAgICAgICAgICAgICBIZWxsb1NpZ24uY2xvc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAvLyBTZW5kICdjYW5jZWwnIG1lc3NhZ2VcbiAgICAgICAgICAgICAgICAgICAgICBpZiAobWVzc2FnZUxpc3RlbmVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGwoJ1JlcG9ydGluZyBjYW5jZWxhdGlvbicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlTGlzdGVuZXIoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2V2ZW50JzogSGVsbG9TaWduLkVWRU5UX0NBTkNFTEVEXG4gICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICB0aGlzLndyYXBwZXIuYXBwZW5kQ2hpbGQodGhpcy5jYW5jZWxCdXR0b24pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGVsc2UgaWYgKCFwYXJhbXNbJ2FsbG93Q2FuY2VsJ10gJiYgdGhpcy5jYW5jZWxCdXR0b24pIHtcbiAgICAgICAgICAgICAgICAgIHRoaXMud3JhcHBlci5yZW1vdmVDaGlsZCh0aGlzLmNhbmNlbEJ1dHRvbik7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gQWRkIGlubGluZSBzdHlsaW5nXG4gICAgICAgICAgICBmb3IgKHZhciBrIGluIHN0eWxlcykge1xuICAgICAgICAgICAgICAgIHZhciBlbCA9IHRoaXNba107XG4gICAgICAgICAgICAgICAgaWYgKGVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgaW4gc3R5bGVzW2tdKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsLnN0eWxlW2ldID0gc3R5bGVzW2tdW2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIElnbm9yZSAtIGV4Y2VwdGlvbnMgZ2V0IHRocm93biB3aGVuIHRoZSBnaXZlbiBzdHlsZSBpcyBub3Qgc3VwcG9ydGVkXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbChlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLmNhbmNlbEJ1dHRvbiAmJiAodGhpcy5pc0ZGIHx8IHRoaXMuaXNPcGVyYSkpIHtcbiAgICAgICAgICAgICAgICAvLyBGaXJlZm94IGlzIHdlaXJkIHdpdGggYmcgaW1hZ2VzXG4gICAgICAgICAgICAgICAgdmFyIHMgPSB0aGlzLmNhbmNlbEJ1dHRvbi5nZXRBdHRyaWJ1dGUoJ3N0eWxlJyk7XG4gICAgICAgICAgICAgICAgcyArPSAocyA/ICc7ICcgOiAnJyk7XG4gICAgICAgICAgICAgICAgcyArPSAnYmFja2dyb3VuZC1pbWFnZTogJyArIHN0eWxlcy5jYW5jZWxCdXR0b25bJ2JhY2tncm91bmQtaW1hZ2UnXSArICc7ICc7XG4gICAgICAgICAgICAgICAgcyArPSAnYmFja2dyb3VuZC1wb3NpdGlvbjogJyArIHN0eWxlcy5jYW5jZWxCdXR0b25bJ2JhY2tncm91bmQtcG9zaXRpb24nXSArICc7JztcbiAgICAgICAgICAgICAgICB0aGlzLmNhbmNlbEJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ3N0eWxlJywgcyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICghdGhpcy5pc0luUGFnZSAmJiAoIXRoaXMuaXNNb2JpbGUgfHwgdGhpcy5pc0RlZmF1bHRVWCkpIHtcbiAgICAgICAgICAgICAgICAvLyBSdW4gcmVzaXplSUZyYW1lIHRvIG1ha2Ugc3VyZSBpdCBmaXRzIGJlc3QgZnJvbSB0aGUgYmVnaW5uaW5nXG4gICAgICAgICAgICAgICAgcmVzaXplSUZyYW1lKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0aGlzLmlzTW9iaWxlICYmICF0aGlzLmlzRGVmYXVsdFVYICYmIHdpbmRvdyA9PT0gd2luZG93LnRvcCkge1xuICAgICAgICAgICAgICAgIC8vIE9ubHkgc2V0IHRoZSBtZXRhIHRhZ3MgZm9yIHRoZSB0b3Agd2luZG93XG4gICAgICAgICAgICAgICAgTWV0YVRhZ0hlbHBlci5zZXQoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHRoaXMuaXNNb2JpbGUgJiYgIXRoaXMuaXNJblBhZ2UpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmZpeElmcmFtZSA9IGRlYm91bmNlKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICB3aW5kb3cuc2Nyb2xsVG8oMCwgMCk7XG4gICAgICAgICAgICAgICAgfSwgMTAwMCk7XG4gICAgICAgICAgICAgICAgdGhpcy5maXhJZnJhbWUoKTtcbiAgICAgICAgICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgdGhpcy5maXhJZnJhbWUpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBDbG9zZSB0aGUgaWZyYW1lIGlmIHBhZ2UgZmFpbHMgdG8gaW5pdGlhbGl6ZSB3aXRoaW4gMTUgc2Vjb25kc1xuICAgICAgICAgICAgaWYgKHRoaXMuaGVhbHRoQ2hlY2tUaW1lb3V0TXMpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9oZWFsdGhDaGVja1RpbWVvdXRIYW5kbGUgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbWVzc2FnZSA9ICdTaWduZXIgcGFnZSBmYWlsZWQgdG8gaW5pdGlhbGl6ZSB3aXRoaW4gJyArIHNlbGYuaGVhbHRoQ2hlY2tUaW1lb3V0TXMgKyAnIG1pbGxpc2Vjb25kcy4nXG4gICAgICAgICAgICAgICAgICAgIHNlbGYucmVwb3J0RXJyb3IobWVzc2FnZSwgZG9jdW1lbnQubG9jYXRpb24uaHJlZik7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICB9LCB0aGlzLmhlYWx0aENoZWNrVGltZW91dE1zKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gU3RhcnQgbGlzdGVuaW5nIGZvciBtZXNzYWdlcyBmcm9tIHRoZSBpRnJhbWVcbiAgICAgICAgICAgIFhXTS5yZWNlaXZlKGZ1bmN0aW9uIF9wYXJlbnRXaW5kb3dDYWxsYmFjayhldnQpe1xuICAgICAgICAgICAgICAgIHZhciBzb3VyY2UgPSBldnQuc291cmNlIHx8ICdoc0VtYmVkZGVkRnJhbWUnO1xuXG4gICAgICAgICAgICAgICAgaWYgKGV2dC5kYXRhID09PSAnaW5pdGlhbGl6ZScgJiYgcGFyYW1zWyd1eFZlcnNpb24nXSA+IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGYuaGVhbHRoQ2hlY2tUaW1lb3V0TXMpIGNsZWFyVGltZW91dChzZWxmLl9oZWFsdGhDaGVja1RpbWVvdXRIYW5kbGUpO1xuICAgICAgICAgICAgICAgICAgICAvLyByZW1vdmUgY29udGFpbmVyIGZyb20gcGF5bG9hZCB0byBwcmV2ZW50IGNpcmN1bGFyIHJlZmVyZW5jZSBlcnJvclxuICAgICAgICAgICAgICAgICAgICB2YXIgcGF5bG9hZCA9IE9iamVjdC5hc3NpZ24oe30sIHBhcmFtcyk7XG4gICAgICAgICAgICAgICAgICAgIGRlbGV0ZSBwYXlsb2FkLmNvbnRhaW5lcjtcbiAgICAgICAgICAgICAgICAgICAgWFdNLnNlbmQoSlNPTi5zdHJpbmdpZnkoeyB0eXBlOiAnZW1iZWRkZWRDb25maWcnLCBwYXlsb2FkOiBwYXlsb2FkIH0pLCBldnQub3JpZ2luLCBzb3VyY2UpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXZ0LmRhdGEgPT0gJ2Nsb3NlJykge1xuICAgICAgICAgICAgICAgICAgICAvLyBDbG9zZSBpRnJhbWVcbiAgICAgICAgICAgICAgICAgICAgSGVsbG9TaWduLmNsb3NlKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKG1lc3NhZ2VMaXN0ZW5lciAmJiBwYXJhbXNbJ3V4VmVyc2lvbiddID4gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZUxpc3RlbmVyKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZXZlbnQnOiBIZWxsb1NpZ24uRVZFTlRfQ0FOQ0VMRURcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChldnQuZGF0YSA9PSAnZGVjbGluZScpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gQ2xvc2UgaUZyYW1lXG4gICAgICAgICAgICAgICAgICAgIEhlbGxvU2lnbi5jbG9zZSgpO1xuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlTGlzdGVuZXIoe1xuICAgICAgICAgICAgICAgICAgICAgICAgJ2V2ZW50JzogSGVsbG9TaWduLkVWRU5UX0RFQ0xJTkVEXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXZ0LmRhdGEgPT0gJ3JlYXNzaWduJykge1xuICAgICAgICAgICAgICAgICAgbWVzc2FnZUxpc3RlbmVyKHtcbiAgICAgICAgICAgICAgICAgICAgJ2V2ZW50JzogSGVsbG9TaWduLkVWRU5UX1JFQVNTSUdORURcbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXZ0LmRhdGEgPT0gJ3VzZXItZG9uZScpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gQ2xvc2UgaUZyYW1lXG4gICAgICAgICAgICAgICAgICAgIEhlbGxvU2lnbi5jbG9zZSgpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGV2dC5kYXRhID09PSAnc3RyaW5nJyAmJiBldnQuZGF0YS5pbmRleE9mKCdoZWxsbzonKSA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBIZWxsbyBtZXNzYWdlIC0gRXh0cmFjdCB0b2tlbiBhbmQgc2VuZCBpdCBiYWNrXG4gICAgICAgICAgICAgICAgICAgIHZhciBwYXJ0cyA9IGV2dC5kYXRhLnNwbGl0KCc6Jyk7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0b2tlbiA9IHBhcnRzWzFdO1xuICAgICAgICAgICAgICAgICAgICBYV00uc2VuZCgnaGVsbG9iYWNrOicgKyB0b2tlbiwgZnJhbWVVcmwsIHNvdXJjZSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChtZXNzYWdlTGlzdGVuZXIgJiYgZXZ0LmRhdGEgJiYgdHlwZW9mIGV2dC5kYXRhID09PSAnc3RyaW5nJykge1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIEZvcndhcmQgdG8gbWVzc2FnZSBjYWxsYmFja1xuICAgICAgICAgICAgICAgICAgICB2YXIgZXZlbnREYXRhID0ge307XG4gICAgICAgICAgICAgICAgICAgIHZhciBwLCBwYWlycyA9IGV2dC5kYXRhLnNwbGl0KCcmJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gUmVjdXJzaXZlIGhlbHBlciBmdW5jdGlvbiB0byBkZXNlcmlhbGl6ZSB0aGUgZXZlbnQgZGF0YS5cbiAgICAgICAgICAgICAgICAgICAgdmFyIGRlc2VyaWFsaXplRXZlbnREYXRhID0gZnVuY3Rpb24oc3RyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgb2JqID0gc3RyO1xuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBTYWZlbHkgcGFyc2UgdGhlIHN0cmluZ1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9iaiA9IEpTT04ucGFyc2Uoc3RyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIG9iaiA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIga2V5IGluIG9iaikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqW2tleV0gPSBwYXJzZUpzb24ob2JqW2tleV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkgeyAvKiBpZ25vcmUgKi8gfVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9iajtcbiAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpPTA7IGk8cGFpcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHAgPSBwYWlyc1tpXS5zcGxpdCgnPScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHAubGVuZ3RoID09PSAyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnREYXRhW3BbMF1dID0gZGVzZXJpYWxpemVFdmVudERhdGEoZGVjb2RlVVJJQ29tcG9uZW50KHBbMV0pKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlTGlzdGVuZXIoZXZlbnREYXRhKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCBvcmlnaW4pO1xuICAgICAgICB9LFxuXG4gICAgICAgIGNsb3NlOiBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgLy8gUmVzZXQgdmlld3BvcnQgc2V0dGluZ3NcbiAgICAgICAgICAgIGlmICh0aGlzLmlzTW9iaWxlICYmICF0aGlzLmlzRGVmYXVsdFVYICYmIHdpbmRvdyA9PT0gd2luZG93LnRvcCkge1xuICAgICAgICAgICAgICAgIE1ldGFUYWdIZWxwZXIucmVzdG9yZSgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBsKCdDbG9zaW5nIEhlbGxvU2lnbiBlbWJlZGRlZCBpRnJhbWUnKTtcbiAgICAgICAgICAgIC8vIENsb3NlIHRoZSBjaGlsZCBpZnJhbWUgZnJvbSB0aGUgcGFyZW50IHdpbmRvd1xuICAgICAgICAgICAgaWYgKHRoaXMuaWZyYW1lKSB7XG4gICAgICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmNhbmNlbEJ1dHRvbikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLndyYXBwZXIucmVtb3ZlQ2hpbGQodGhpcy5jYW5jZWxCdXR0b24pO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNhbmNlbEJ1dHRvbiA9IG51bGw7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuX2ZhZGVPdXRJRnJhbWUoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHRoaXMuaXNNb2JpbGUpIHtcbiAgICAgICAgICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgdGhpcy5maXhJZnJhbWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG5cbiAgICAgICAgLy8gIC0tLS0gIFBSSVZBVEUgTUVUSE9EUyAgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgICAgIF9mYWRlT3V0SUZyYW1lOiBmdW5jdGlvbiBfZmFkZU91dElGcmFtZShjdXJyZW50T3BhY2l0eSkge1xuICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICAgICAgaWYgKHNlbGYuaWZyYW1lKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFjdXJyZW50T3BhY2l0eSkge1xuICAgICAgICAgICAgICAgICAgICBjdXJyZW50T3BhY2l0eSA9IDEuMDtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjdXJyZW50T3BhY2l0eSAtPSAwLjE7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHNlbGYuaWZyYW1lLnN0eWxlLm9wYWNpdHkgPSBjdXJyZW50T3BhY2l0eTtcbiAgICAgICAgICAgICAgICBzZWxmLmlmcmFtZS5zdHlsZS5maWx0ZXIgPSAnYWxwaGEob3BhY2l0eT0nICsgcGFyc2VJbnQoY3VycmVudE9wYWNpdHkgKiAxMDAsIDEwKSArICcpJztcbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudE9wYWNpdHkgPD0gMC4wKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuaWZyYW1lLnN0eWxlLm9wYWNpdHkgPSAwO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLmlmcmFtZS5zdHlsZS5maWx0ZXIgPSAnYWxwaGEob3BhY2l0eT0wKSc7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuaWZyYW1lLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgICAgICAgICAgICAgICAgIGNsZWFyVGltZW91dChhbmltYXRpb25UaW1lcik7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzZWxmLm92ZXJsYXkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuY29udGFpbmVyLnJlbW92ZUNoaWxkKHNlbGYub3ZlcmxheSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgc2VsZi5jb250YWluZXIucmVtb3ZlQ2hpbGQoc2VsZi53cmFwcGVyKTtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi53cmFwcGVyLnJlbW92ZUNoaWxkKHNlbGYuaWZyYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5vdmVybGF5ID0gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5pZnJhbWUgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICBzZWxmLndyYXBwZXIgPSBudWxsO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHZhciBhbmltYXRpb25UaW1lciA9IHNldFRpbWVvdXQoKGZ1bmN0aW9uKGN1cnJlbnRPcGFjaXR5KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX2ZhZGVPdXRJRnJhbWUoY3VycmVudE9wYWNpdHkpO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH0pKGN1cnJlbnRPcGFjaXR5KSwgMTApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIHJlcG9ydEVycm9yOiBmdW5jdGlvbihlcnJvck1lc3NhZ2UsIHBhcmVudFVybCkge1xuICAgICAgICAgICAgWFdNLnNlbmQoe1xuICAgICAgICAgICAgICAgICdldmVudCc6IEhlbGxvU2lnbi5FVkVOVF9FUlJPUixcbiAgICAgICAgICAgICAgICAnZGVzY3JpcHRpb24nOiBlcnJvck1lc3NhZ2VcbiAgICAgICAgICAgIH0sIHBhcmVudFVybCk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgZW5zdXJlUGFyZW50RG9tYWluOiBmdW5jdGlvbihkb21haW5OYW1lLCBwYXJlbnRVcmwsIHRva2VuLCBza2lwRG9tYWluVmVyaWZpY2F0aW9uLCBjYWxsYmFjaykge1xuXG4gICAgICAgICAgICAvLyBkb21haW5OYW1lOiAgRG9tYWluIHRvIG1hdGNoIGFnYWluc3QgdGhlIHBhcmVudCB3aW5kb3cgbG9jYXRpb25cbiAgICAgICAgICAgIC8vIHBhcmVudFVybDogICBVcmwgb2YgdGhlIHBhcmVudCB3aW5kb3cgdG8gY2hlY2sgKHByb3ZpZGVkIHRvIHVzIGJ1dCBub3QgcmVsaWFibGUpXG4gICAgICAgICAgICAvLyBjYWxsYmFjazogICAgTWV0aG9kIHRvIGNhbGwgd2l0aCB0aGUgcmVzdWx0LCBpdCBzaG91bGQgdGFrZSBvbmx5IG9uZSBib29sZWFuIHBhcmFtZXRlci5cblxuICAgICAgICAgICAgaWYgKHdpbmRvdy50b3AgPT0gd2luZG93KSB7XG4gICAgICAgICAgICAgICAgLy8gTm90IGluIGFuIGlGcmFtZSwgbm8gbmVlZCB0byBnbyBmdXJ0aGVyXG4gICAgICAgICAgICAgICAgY2FsbGJhY2sodHJ1ZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodHlwZW9mIHRva2VuICE9PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgIGVycm9yKCdUb2tlbiBub3Qgc3VwcGxpZWQgYnkgSGVsbG9TaWduLiBQbGVhc2UgY29udGFjdCBzdXBwb3J0LicpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHR5cGVvZiBjYWxsYmFjayAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgIGVycm9yKCdDYWxsYmFjayBub3Qgc3VwcGxpZWQgYnkgSGVsbG9TaWduLiBQbGVhc2UgY29udGFjdCBzdXBwb3J0LicpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuXG4gICAgICAgICAgICBpZiAoc2tpcERvbWFpblZlcmlmaWNhdGlvbiA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgIHZhciB3YXJuaW5nTXNnID0gJ0RvbWFpbiB2ZXJpZmljYXRpb24gaGFzIGJlZW4gc2tpcHBlZC4gQmVmb3JlIHJlcXVlc3RpbmcgYXBwcm92YWwgZm9yIHlvdXIgYXBwLCBwbGVhc2UgYmUgc3VyZSB0byB0ZXN0IGRvbWFpbiB2ZXJpZmljYXRpb24gYnkgc2V0dGluZyBza2lwRG9tYWluVmVyaWZpY2F0aW9uIHRvIGZhbHNlLic7XG4gICAgICAgICAgICAgICAgbCh3YXJuaW5nTXNnKTtcbiAgICAgICAgICAgICAgICBhbGVydCh3YXJuaW5nTXNnKTtcbiAgICAgICAgICAgICAgICBjYWxsYmFjayh0cnVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIFN0YXJ0cyB3YWl0aW5nIGZvciB0aGUgaGVsbG8gYmFjayBtZXNzYWdlXG4gICAgICAgICAgICAgICAgWFdNLnJlY2VpdmUoZnVuY3Rpb24gX2Vuc3VyZVBhcmVudERvbWFpbkNhbGxiYWNrKGV2dCl7XG4gICAgICAgICAgICAgICAgICAgIGlmIChldnQuZGF0YS5pbmRleE9mKCdoZWxsb2JhY2s6JykgPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXJ0cyA9IGV2dC5kYXRhLnNwbGl0KCc6Jyk7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmFsaWQgPSAocGFydHNbMV0gPT0gdG9rZW4pO1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2sodmFsaWQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSwgZG9tYWluTmFtZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFNlbmQgaGVsbG8gbWVzc2FnZVxuICAgICAgICAgICAgWFdNLnNlbmQoJ2hlbGxvOicgKyB0b2tlbiwgcGFyZW50VXJsKTtcbiAgICAgICAgfSxcblxuICAgICAgICBnZXRXaW5kb3dEaW1lbnNpb25zOiBmdW5jdGlvbihjdXN0b21IZWlnaHQpIHtcbiAgICAgICAgICAgIHZhciBzY3JvbGxYID0gZ2V0U2Nyb2xsWCgpO1xuICAgICAgICAgICAgdmFyIHNjcm9sbFkgPSBnZXRTY3JvbGxZKCk7XG4gICAgICAgICAgICB2YXIgd2luZG93V2lkdGgsIHdpbmRvd0hlaWdodDtcblxuICAgICAgICAgICAgaWYgKHRoaXMuaXNPbGRJRSkge1xuICAgICAgICAgICAgICAgIHdpbmRvd1dpZHRoICAgPSBkb2N1bWVudC5ib2R5LmNsaWVudFdpZHRoO1xuICAgICAgICAgICAgICAgIHdpbmRvd0hlaWdodCAgPSBkb2N1bWVudC5ib2R5LmNsaWVudEhlaWdodDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgd2luZG93V2lkdGggICA9IHdpbmRvdy5pbm5lcldpZHRoO1xuICAgICAgICAgICAgICAgIHdpbmRvd0hlaWdodCAgPSB3aW5kb3cuaW5uZXJIZWlnaHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgaGVpZ2h0ID0gdGhpcy5pc0luUGFnZSAmJiBjdXN0b21IZWlnaHQgPyBjdXN0b21IZWlnaHQgOiBNYXRoLm1heCh0aGlzLk1JTl9IRUlHSFQsIHdpbmRvd0hlaWdodCAtIDYwKTtcblxuICAgICAgICAgICAgdmFyIHdpZHRoID0gdGhpcy51eFZlcnNpb24gPiAxID8gTWF0aC5taW4odGhpcy5ERUZBVUxUX1dJRFRILCB3aW5kb3dXaWR0aCAqIHRoaXMuSUZSQU1FX1dJRFRIX1JBVElPKSA6IHRoaXMuREVGQVVMVF9XSURUSDtcblxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAnd2lkdGhTdHJpbmcnOiAgd2lkdGggKyAncHgnLFxuICAgICAgICAgICAgICAgICdoZWlnaHRTdHJpbmcnOiBoZWlnaHQgKyAncHgnLFxuICAgICAgICAgICAgICAgICdoZWlnaHRSYXcnOiAgICBoZWlnaHQsXG4gICAgICAgICAgICAgICAgJ3Njcm9sbFgnOiAgICAgIHNjcm9sbFgsXG4gICAgICAgICAgICAgICAgJ3Njcm9sbFknOiAgICAgIHNjcm9sbFksXG4gICAgICAgICAgICAgICAgJ3RvcCcgOiAgICAgICAgIE1hdGgubWF4KDAsIHNjcm9sbFkgKyBwYXJzZUludCgod2luZG93SGVpZ2h0IC0gaGVpZ2h0KSAvIDIsIDEwKSkgKyAncHgnLFxuICAgICAgICAgICAgICAgICdsZWZ0JzogICAgICAgICBNYXRoLm1heCgwLCBwYXJzZUludCgod2luZG93V2lkdGggLSB0aGlzLkRFRkFVTFRfV0lEVEgpIC8gMiwgMTApKSArICdweCdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0sXG5cbiAgICAgICAgZ2V0TW9iaWxlRGltZW5zaW9uczogZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIHZhciBkaW1zO1xuXG4gICAgICAgICAgICB2YXIgc2NyZWVuV2lkdGggPSBzY3JlZW4ud2lkdGg7XG4gICAgICAgICAgICB2YXIgc2NyZWVuSGVpZ2h0ID0gc2NyZWVuLmhlaWdodDtcbiAgICAgICAgICAgIHZhciB3aW5kb3dXaWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoO1xuICAgICAgICAgICAgdmFyIHdpbmRvd0hlaWdodCA9IHdpbmRvdy5pbm5lckhlaWdodDtcblxuICAgICAgICAgICAgdmFyIGlzUG9ydHJhaXQgPSB3aW5kb3dIZWlnaHQgPiB3aW5kb3dXaWR0aDtcblxuICAgICAgICAgICAgaWYgKGlzUG9ydHJhaXQpIHtcbiAgICAgICAgICAgICAgICBkaW1zID0ge1xuICAgICAgICAgICAgICAgICAgICAnd2lkdGhTdHJpbmcnOiB0aGlzLmlzRGVmYXVsdFVYID8gJzEwMHZ3JyA6IHNjcmVlbldpZHRoICsgJ3B4JyxcbiAgICAgICAgICAgICAgICAgICAgJ2hlaWdodFN0cmluZyc6IHRoaXMuaXNEZWZhdWx0VVggPyAnMTAwdmgnIDogJzEwMCUnIC8vIDEwMHZoIG5lZWRlZCBmb3Igb2xkIHNpZ25lciBwYWdlLCBidXQgY3V0cyBvZmYgc29tZSBuZXdlciBVWCBlbGVtZW50c1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIExhbmRzY2FwZVxuICAgICAgICAgICAgICAgIGRpbXMgPSB7XG4gICAgICAgICAgICAgICAgICAgICd3aWR0aFN0cmluZyc6IHdpbmRvd1dpZHRoICsgJ3B4JyxcbiAgICAgICAgICAgICAgICAgICAgJ2hlaWdodFN0cmluZyc6IHRoaXMuaXNEZWZhdWx0VVggPyAnMTAwdmgnIDogJzEwMCUnXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIEFsd2F5cyBmaWxsIHNjcmVlbiBvbiBtb2JpbGVcbiAgICAgICAgICAgIGRpbXMudG9wID0gJzAnO1xuICAgICAgICAgICAgZGltcy5sZWZ0ID0gJzAnO1xuICAgICAgICAgICAgcmV0dXJuIGRpbXM7XG4gICAgICAgIH0sXG5cbiAgICAgICAgaW5BcnJheTogZnVuY3Rpb24odiwgYXJyYXkpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmhhc0pRdWVyeSkge1xuICAgICAgICAgICAgICAgIHJldHVybiAkLmluQXJyYXkodiwgYXJyYXkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoYXJyYXkpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpPTA7IGk8YXJyYXkubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGFycmF5W2ldID09IHYpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICB9LFxuXG4gICAgICAgIHNhZmVVcmw6IGZ1bmN0aW9uKHVybCkge1xuICAgICAgICAgICAgaWYgKHVybCkge1xuICAgICAgICAgICAgICAgIHRyeSB7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gU2VjdXJpdHk6IHJlbW92ZSBzY3JpcHQgdGFncyBmcm9tIFVSTHMgYmVmb3JlIHByb2Nlc3NpbmdcbiAgICAgICAgICAgICAgICAgICAgdXJsID0gdXJsLnJlcGxhY2UoLzwvZywgXCImbHQ7XCIpO1xuICAgICAgICAgICAgICAgICAgICB1cmwgPSB1cmwucmVwbGFjZSgvPi9nLCBcIiZndDtcIik7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gSFRNTC1EZWNvZGUgdGhlIGdpdmVuIHVybCBpZiBuZWNlc3NhcnksIGJ5IHJlbmRlcmluZyB0byB0aGUgcGFnZVxuICAgICAgICAgICAgICAgICAgICB2YXIgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgICAgICAgICAgZWwuaW5uZXJIVE1MID0gdXJsO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZGVjb2RlZFVybCA9IGVsLmlubmVyVGV4dDtcblxuICAgICAgICAgICAgICAgICAgICAvLyBGYWxsIGJhY2sgdG8ganVzdCByZXBsYWNpbmcgJyZhbXA7JyBpbiBjYXNlIG9mIGZhaWx1cmVcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFkZWNvZGVkVXJsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB1cmwgPSB1cmwucmVwbGFjZSgvXFwmYW1wXFw7L2csICcmJyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB1cmwgPSBkZWNvZGVkVXJsO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgIGwoJ0NvdWxkIG5vdCBkZWNvZGUgdXJsOiAnICsgZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHVybDtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICAvKipcbiAgICAgKiBXcmFwcGVyIHRoYXQgd2lsbCBlbnN1cmUgYW4gZXJyb3IgbWVzc2FnZSBpcyBkaXNwbGF5ZWQsIGVpdGhlciBpbiBjb25zb2xlLmxvZ1xuICAgICAqIG9yIGFzIGEgYnJvd3NlciBhbGVydC5cbiAgICAgKiBAcGFyYW0gbWVzc2FnZSBTdHJpbmcgZXJyb3IgbWVzc2FnZVxuICAgICAqL1xuXG4gICAgZnVuY3Rpb24gZXJyb3IobWVzc2FnZSkge1xuICAgICAgICBpZiAodHlwZW9mIG1lc3NhZ2UgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICBpZiAod2luZG93LmNvbnNvbGUgJiYgY29uc29sZS5sb2cpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhtZXNzYWdlKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgYWxlcnQobWVzc2FnZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDdXN0b20gd3JhcHBlciB0aGF0IGNvbmRpdGlvbmFsbHkgbG9ncyBtZXNzYWdlcyB0byBjb25zb2xlLmxvZy5cbiAgICAgKiBAcGFyYW0gbWVzc2FnZU9iaiBTdHJpbmcgb3IgT2JqZWN0IHRvIGxvZ1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIGwobWVzc2FnZU9iaikge1xuICAgICAgICBpZiAoSGVsbG9TaWduLmlzRGVidWdFbmFibGVkICYmIHR5cGVvZiBtZXNzYWdlT2JqICE9PSAndW5kZWZpbmVkJyAmJlxuICAgICAgICAgICAgd2luZG93LmNvbnNvbGUgJiYgY29uc29sZS5sb2cpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKG1lc3NhZ2VPYmopO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogIEdldHRlciBmdW5jdGlvbnMgZm9yIGRldGVybWluaW5nIHNjcm9sbCBwb3NpdGlvbiB0aGF0IHdvcmsgb24gYWxsXG4gICAgICogIGJyb3dzZXJzLlxuICAgICAqL1xuXG4gICAgZnVuY3Rpb24gZ2V0U2Nyb2xsWCgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBwb3J0UGFnZU9mZnNldCgpID8gd2luZG93LnBhZ2VYT2Zmc2V0IDogX2lzQ1NTMUNvbXBhdCgpID8gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbExlZnQgOiBkb2N1bWVudC5ib2R5LnNjcm9sbExlZnQ7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZ2V0U2Nyb2xsWSgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBwb3J0UGFnZU9mZnNldCgpID8gd2luZG93LnBhZ2VZT2Zmc2V0IDogX2lzQ1NTMUNvbXBhdCgpID8gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcCA6IGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIF9pc0NTUzFDb21wYXQoKSB7XG4gICAgICAgIHJldHVybiAoKGRvY3VtZW50LmNvbXBhdE1vZGUgfHwgJycpID09PSAnQ1NTMUNvbXBhdCcpO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIF9zdXBwb3J0UGFnZU9mZnNldCgpIHtcbiAgICAgICAgcmV0dXJuIHdpbmRvdy5wYWdlWE9mZnNldCAhPT0gdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIC8vIEFsc28gYWRkIEhlbGxvU2lnbiBhcyBnbG9iYWwgdmFyaWFibGUgZm9yIEFNRCBpbXBsZW1lbnRhdGlvbnMuXG4gICAgLy8gVGhpcyB3aWxsIHByZXZlbnQgb2xkZXIgaW50ZWdyYXRpb25zIGZyb20gYnJlYWtpbmcuXG4gICAgaWYgKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkge1xuICAgICAgd2luZG93LkhlbGxvU2lnbiA9IEhlbGxvU2lnbjtcbiAgICB9XG5cbiAgICAvLyBFeHBvcnQgdGhlIEhTIG9iamVjdFxuICAgIG1vZHVsZS5leHBvcnRzID0gSGVsbG9TaWduO1xuXG59KSgpO1xuIl0sInNvdXJjZVJvb3QiOiIifQ==